{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome","text":"<p>Bonjour a toi visiteur \ud83d\udc4b Si tu est arriv\u00e9 ici par hazard, sache que ce site est la sauvegarde  de mon cerveau fatigu\u00e9...  j'y note quelques astuce, m'\u00e9vitant ainsi de m'encombrer la t\u00eate  Si cela peut servir a d'autres, profites </p>"},{"location":"Backup/TSM/","title":"TSM","text":""},{"location":"Backup/TSM/#recuperer-un-ou-plusieurs-fichiers-selon-la-date","title":"Recuperer un ou plusieurs fichiers selon la date","text":"<p>Se positionner dans le r\u00e9pertoire qui a contenu les fichiers \u00e0 restaurer Interroger TSM</p> <pre><code>dsmc query backup '*' -pitd='2011-09-22'\n</code></pre> <p>Puis restaurer (avec l'option -Inact si fichier inactif = Depend de la duree de retention de la classe TSM )</p> <pre><code>dsmc restore -Inact '*' -pitd='2011-09-22' '/tempspace/RESTORE/'\n</code></pre>"},{"location":"Backup/TSM/#recuperer-un-ou-plusieurs-fichiers-depuis-un-virtualnode-different","title":"R\u00e9cuperer un ou plusieurs fichiers depuis un virtualnode different","text":"<pre><code>dsmc query backup '/expl/tomi/tomX/exit/tomgsurv*' \u2013virtualnode='infoexpl8'\n\ndsmc restore '/DOSSIER/SOURCE/' '/DOSSIER/CIBLE' \u2013virtualnode='infoexpl8'\n</code></pre>"},{"location":"Backup/TSM/#restaurer-vers-un-serveur-tsm-different","title":"Restaurer vers un serveur TSM diff\u00e9rent","text":"<p>Windows</p> <pre><code>dsmc restore '&lt;SOURCE&gt;' '&lt;DEST&gt;' -optfile=\"C:\\Program Files\\Tivoli\\Tsm\\Baclient\\dsm.opt\" -virtualnode=HNANSSNORA10006\n</code></pre> <p>UNIX</p> <pre><code>dsmc restore -se=TSMEXPL1\n</code></pre>"},{"location":"Backup/TSM/#diverse-commande","title":"Diverse commande","text":"<pre><code>dsmc incremental 'toto.zip' = pour un fichier existant\n\ndsmc backup 'toto.zip' = pour un nouveau fichier\n</code></pre>"},{"location":"Code/Curl/","title":"Curl","text":""},{"location":"Code/Curl/#curl","title":"Curl","text":""},{"location":"Code/Curl/#passage-du-yes-lors-de-lexecution-dun-shell","title":"Passage du \"yes\" lors de l'ex\u00e9cution d'un shell","text":"<pre><code>sh -c \"$(curl -fsSL https://starship.rs/install.sh)\" -y -f\n</code></pre> <p>Note</p> <p>Valider que ca fonctionne avec d'autres outils que curl</p> <p> </p>"},{"location":"Code/Perl/","title":"Perl","text":""},{"location":"Code/Perl/#perl-operator","title":"Perl operator","text":"<pre><code>Standard  G\u00e9n\u00e9rique    Signification   Interpolation\n        ''       q{}         Litt\u00e9rale            non\n        \"\"      qq{}         Litt\u00e9rale            oui\n        ``      qx{}          Commande            oui (sauf si d\u00e9limiteur '')\n                qw{}        Liste de mots         non\n        //       m{}   Reconnaissance de motif    oui (sauf si d\u00e9limiteur '')\n                qr{}           Motif              oui (sauf si d\u00e9limiteur '')\n                 s{}{}       Substitution         oui (sauf si d\u00e9limiteur '')\n                tr{}{}     Translitt\u00e9ration       non (voir plus bas)\n\n\\t          tabulation             (HT, TAB)\n\\n          nouvelle ligne         (LF, NL)\n\\r          retour chariot         (CR)\n\\f          page suivante          (FF)\n\\a          alarme (bip)           (BEL)\n\\e          escape                 (ESC)\n\\033        caract\u00e8re en octal     (ESC)\n\\x1B        caract\u00e8re hexad\u00e9cimal  (ESC)\n\\x{236a}    caract\u00e8re hexad\u00e9cimal long (SMILEY)\n\\c[         caract\u00e8re de contr\u00f4le  (ESC)\n\\N{nom}     caract\u00e8re nomm\u00e9\n\n\\l          converti en minuscule le caract\u00e8re suivant\n\\u          converti en majuscule le caract\u00e8re suivant\n\\L          converti en minuscule jusqu'au prochain \\E\n\\U          converti en majuscule jusqu'au prochain \\E\n\\E          fin de modification de casse\n\\Q          d\u00e9sactive les m\u00e9ta-caract\u00e8res de motif jusqu'au prochain \\E\n````\n\n## Snippet  \n\n### Recherche d'une occurence dans un tableau  \n\nIt depends on what you want the search to do:\n\nif you want to find all matches, use the built-in grep:  \n```perl     \n    my @matches = grep { /pattern/ } @list_of_strings;\n</code></pre> <p>if you want to find the first match, use first in List::Util: <pre><code>    use List::Util 'first';\n    my $match = first { /pattern/ } @list_of_strings;\n</code></pre></p> <p>if you want to find the count of all matches, use true in List::MoreUtils: <pre><code>    use List::MoreUtils 'true';\n    my $count = true { /pattern/ } @list_of_strings;\n</code></pre></p> <p>if you want to know the index of the first match, use first_index in List::MoreUtils: <pre><code>    use List::MoreUtils 'first_index';\n    my $index = first_index { /pattern/ } @list_of_strings;\n</code></pre></p> <p>if you want to simply know if there was a match, but you don\u2019t care which element it was or its value, use any in List::MoreUtils: <pre><code>    use List::MoreUtils 'any';\n    my $match_found = any { /pattern/ } @list_of_strings;\n</code></pre></p>"},{"location":"Code/Perl/#lister-les-doublons-ou-les-uniques-dans-un-tableau","title":"Lister les doublons ou les uniques dans un tableau","text":"<pre><code>    my %seen;\n    my @doublons = grep {++$seen{$_}==2} @liste\n\n    my %seen;\n    my @unique = grep {++$seen{$_}==1} @liste\n</code></pre>"},{"location":"Code/Powershell/","title":"Powershell","text":""},{"location":"Code/Powershell/#variable-denvironnement","title":"Variable d'environnement","text":""},{"location":"Code/Powershell/#remplacer-etou-supprimer-une-variable-denvironnement","title":"Remplacer et/ou supprimer une variable d'environnement","text":"<pre><code>$actualpath = $Env:Path\n$newpath = $path.replace(\"C:\\WINDOWS\\System32\\OpenSSH\\;\",\"\")\n$env:Path = $newpath\n</code></pre>"},{"location":"Code/Powershell/#ajouter-une-variable-denvironnement","title":"Ajouter une variable d'environnement","text":"<pre><code>$actualpath = $Env:Path\n$addPath = 'C:\\Program Files\\Oracle\\VirtualBox'\n$env:Path += \";$addpath\"\n</code></pre>"},{"location":"Code/Python/","title":"Python","text":""},{"location":"Code/Python/#creer-un-serveur-http-en-python","title":"Cr\u00e9er un serveur HTTP en Python","text":"<p>Avec Python 2 : </p> <pre><code>python -m SimpleHTTPServer port \n</code></pre> <p>Avec Python 3 :  <pre><code>python -m http.server port \n</code></pre></p> <p>Credit : Matt http://doc.callmematthi.eu</p>"},{"location":"Code/Python/#ecrire-dans-un-fichier","title":"Ecrire dans un fichier","text":"<pre><code>#!/usr/bin/python\n\ntext_file = open(\"/tmp/send.txt\", \"w\")\ntext_file.write(strMsg)\ntext_file.close()\n</code></pre>"},{"location":"Code/Shell/","title":"Shell","text":""},{"location":"Code/Shell/#en-vrac","title":"En vrac","text":""},{"location":"Code/Shell/#strict-mode-bash","title":"\"Strict mode\" bash","text":"<pre><code>set -euo pipefail\nIFS=$'\\n\\t'\n</code></pre> <p>See: Unofficial bash strict mode</p>"},{"location":"Code/Shell/#modifier-les-couleurs-dans-un-shell-redhat","title":"Modifier les couleurs dans un shell (RedHat)","text":"<p>Editer le fichier /etc/DIR_COLORS et remplacer  <code>DIR 00;34       # directory</code> par <code>DIR 00;32       # directory</code></p> <p>Note</p> <p>Les r\u00e9pertoires vont apparaitre en vert au lieu de bleu</p> <p> </p>"},{"location":"Code/Shell/#clear-screen-like-en-shell","title":"Clear screen \"like\" en shell","text":"<pre><code>echo -en \"\\ec\"\n</code></pre>"},{"location":"Code/Shell/#faire-un-calcul-en-shell","title":"Faire un calcul en shell","text":"<pre><code>echo $((0+0)) \n</code></pre> <pre><code>$((a + 200))      # Add 200 to $a\n</code></pre> <pre><code>$(($RANDOM%200))  # Random number 0..199\n</code></pre> <p>Note</p> <p>Permet de faire un calcul , notamment dans ce cas pr\u00e9cis, ou un r\u00e9sultat \u00e9gale \u00e0 0 fait planter expr</p> <p> </p>"},{"location":"Code/Shell/#lire-une-entree-stdin","title":"Lire une entr\u00e9e STDIN","text":"<p><pre><code>echo -n \"Proceed? [y/n]: \"\nread ans\necho $ans\n</code></pre> </p> <p>Note</p> <p>lecture STDIN si option, sinon, fichier <pre><code>test() { \nif [ \"$1\" == \"-\" ]; then \n    cat &lt;&amp;0 \nelse \n    cat \"$1\"\nfi \n}\n</code></pre></p> <p> </p>"},{"location":"Code/Shell/#gestion-des-options-dans-un-menu","title":"Gestion des options dans un menu","text":"<pre><code>while [[ \"$1\" =~ ^- &amp;&amp; ! \"$1\" == \"--\" ]]; do case $1 in\n  -V | --version )\n    echo $version\n    exit\n    ;;\n  -s | --string )\n    shift; string=$1\n    ;;\n  -f | --flag )\n    flag=1\n    ;;\nesac; shift; done\nif [[ \"$1\" == '--' ]]; then shift; fi\n</code></pre>"},{"location":"Code/Shell/#redirections","title":"Redirections","text":"<pre><code>python hello.py &gt; output.txt   # stdout to (file)\npython hello.py &gt;&gt; output.txt  # stdout to (file), append\npython hello.py 2&gt; error.log   # stderr to (file)\npython hello.py 2&gt;&amp;1           # stderr to stdout\npython hello.py &gt; output.txt 2&gt;&amp;1  # stderr to stdout (file and no screen output)\npython hello.py 2&gt;/dev/null    # stderr to (null)\npython hello.py &amp;&gt;/dev/null    # stdout and stderr to (null)\n</code></pre>"},{"location":"Code/Shell/#variables-specifique","title":"Variables sp\u00e9cifique","text":""},{"location":"Code/Shell/#environnement","title":"Environnement","text":"Expression Description <code>$HOME</code> chemin du r\u00e9pertoire personnel de l'utilisateur <code>$OLDPWD</code> chemin du r\u00e9pertoire pr\u00e9c\u00e9dent <code>$PATH</code> liste des chemins de recherche des commandes ex\u00e9cutables <code>$PPID</code> PID du processus p\u00e8re du shell <code>$PS1</code> invite principale du shell <code>$PS2</code> invite secondaire du shell <code>$PS3</code> invite de la structure shell \"select\" <code>$PS4</code> invite de l'option shell de d\u00e9bogage \"xtrace\" <code>$PWD</code> chemin du r\u00e9pertoire courant <code>$RANDOM</code> nombre entier al\u00e9atoire compris entre 0 et 32767 <code>$REPLY</code> variable par d\u00e9faut de la commande \"read\" et de la structure shell \"select\" <code>$SECONDS</code> nombre de secondes \u00e9coul\u00e9es depuis le lancement du shell"},{"location":"Code/Shell/#status","title":"Status","text":"Expression Description <code>$?</code> Exit status de la derni\u00e8re tache <code>$!</code> PID de la derni\u00e8re tache en BG <code>$$</code> PID du shell <code>$0</code> Nom du script shell"},{"location":"Code/Shell/#arguments","title":"Arguments","text":"Expression Description <code>$#</code> Nombre d'arguments <code>$*</code> Tous les arguments <code>$@</code> Tous les arguments, en commencant par le premier <code>$1</code> Premier argument <code>$_</code> Argument de la derni\u00e8re commande"},{"location":"Code/Shell/#variable-avec-valeur-par-defaut","title":"Variable avec valeur par d\u00e9faut","text":"Expression Description <code>${FOO:-val}</code> <code>$FOO</code>, or <code>val</code> if unset (or null) <code>${FOO:=val}</code> Set <code>$FOO</code> to <code>val</code> if unset (or null) <code>${FOO:+val}</code> <code>val</code> if <code>$FOO</code> is set (and not null) <code>${FOO:?message}</code> Show error message and exit if <code>$FOO</code> is unset (or null) <p>Omitting the <code>:</code> removes the (non)nullity checks, e.g. <code>${FOO-val}</code> expands to <code>val</code> if unset otherwise <code>$FOO</code>.</p> <p> </p>"},{"location":"Code/Shell/#substrings","title":"Substrings","text":"Expression Description <code>${FOO:0:3}</code> Substring (position, length) <code>${FOO:(-3):3}</code> Substring from the right"},{"location":"Code/Shell/#longueur","title":"Longueur","text":"Expression Description <code>${#FOO}</code> Taille de la variable <code>$FOO</code>"},{"location":"Code/Shell/#braket-expension","title":"Braket expension","text":"<pre><code>echo {A,B}.js\n</code></pre> Expression Description <code>{A,B}</code> Same as <code>A B</code> <code>{A,B}.js</code> Same as <code>A.js B.js</code> <code>{1..5}</code> Same as <code>1 2 3 4 5</code>"},{"location":"Code/Shell/#manipulation","title":"Manipulation","text":"<p>variable</p> <pre><code>STR=\"HELLO WORLD!\"\necho ${STR,}   #=&gt; \"hELLO WORLD!\" (lowercase 1st letter)\necho ${STR,,}  #=&gt; \"hello world!\" (all lowercase)\n\nSTR=\"hello world!\"\necho ${STR^}   #=&gt; \"Hello world!\" (uppercase 1st letter)\necho ${STR^^}  #=&gt; \"HELLO WORLD!\" (all uppercase)\n</code></pre> <pre><code>name=\"John\"\necho ${name}\necho ${name/J/j}    #=&gt; \"john\" (substitution)\necho ${name:0:2}    #=&gt; \"Jo\" (slicing)\necho ${name::2}     #=&gt; \"Jo\" (slicing)\necho ${name::-1}    #=&gt; \"Joh\" (slicing)\necho ${name:(-1)}   #=&gt; \"n\" (slicing from right)\necho ${name:(-2):1} #=&gt; \"h\" (slicing from right)\necho ${food:-Cake}  #=&gt; $food or \"Cake\"\n</code></pre> <p>r\u00e9pertoire <pre><code>STR=\"/path/to/foo.cpp\"\necho ${STR%.cpp}    # /path/to/foo\necho ${STR%.cpp}.o  # /path/to/foo.o\necho ${STR%/*}      # /path/to\n\necho ${STR##*.}     # cpp (extension)\necho ${STR##*/}     # foo.cpp (basepath)\n\necho ${STR#*/}      # path/to/foo.cpp\necho ${STR##*/}     # foo.cpp\n\necho ${STR/foo/bar} # /path/to/bar.cpp\n</code></pre> <pre><code>STR=\"Hello world\"\necho ${STR:6:5}   # \"world\"\necho ${STR: -5:5}  # \"world\"\n</code></pre></p> <pre><code>SRC=\"/path/to/foo.cpp\"\nBASE=${SRC##*/}   #=&gt; \"foo.cpp\" (basepath)\nDIR=${SRC%$BASE}  #=&gt; \"/path/to/\" (dirpath)\n</code></pre> <p> </p>"},{"location":"Code/Shell/#substitution","title":"Substitution","text":"Code Description <code>${FOO%suffix}</code> Supprimer suffix <code>${FOO#prefix}</code> Supprimer prefix --- --- <code>${FOO%%suffix}</code> Supprimer long suffix <code>${FOO##prefix}</code> Supprimer long prefix --- --- <code>${FOO/from/to}</code> Remplacer premier match <code>${FOO//from/to}</code> Remplacer tout --- --- <code>${FOO/%from/to}</code> Remplacer suffix <code>${FOO/#from/to}</code> Remplacer prefix"},{"location":"Code/Shell/#tableau","title":"Tableau","text":""},{"location":"Code/Shell/#definition-dun-tableau","title":"Definition d'un tableau","text":"<pre><code>Fruits=('Apple' 'Banana' 'Orange')\n</code></pre> <pre><code>Fruits[0]=\"Apple\"\nFruits[1]=\"Banana\"\nFruits[2]=\"Orange\"\n</code></pre>"},{"location":"Code/Shell/#gestion-dun-tableau","title":"Gestion d'un tableau","text":"<pre><code>echo ${Fruits[0]}           # Element #0\necho ${Fruits[-1]}          # Last element\necho ${Fruits[@]}           # All elements, space-separated\necho ${#Fruits[@]}          # Number of elements\necho ${#Fruits}             # String length of the 1st element\necho ${#Fruits[3]}          # String length of the Nth element\necho ${Fruits[@]:3:2}       # Range (from position 3, length 2)\necho ${!Fruits[@]}          # Keys of all elements, space-separated\n</code></pre>"},{"location":"Code/Shell/#operations-sur-un-tableau","title":"Operations sur un tableau","text":"<pre><code>Fruits=(\"${Fruits[@]}\" \"Watermelon\")    # Push\nFruits+=('Watermelon')                  # Also Push\nFruits=( ${Fruits[@]/Ap*/} )            # Remove by regex match\nunset Fruits[2]                         # Remove one item\nFruits=(\"${Fruits[@]}\")                 # Duplicate\nFruits=(\"${Fruits[@]}\" \"${Veggies[@]}\") # Concatenate\nlines=(`cat \"logfile\"`)                 # Read from file\n</code></pre>"},{"location":"Code/Shell/#utilisation-dun-tableau-en-shell","title":"Utilisation d'un tableau en shell","text":"<pre><code>#!/bin/bash\n\ndeclare -A dict\ndict=( [\u2018a\u2019]=1\n       [\u2018b\u2019]=2\n       [\u2018c\u2019]=3 )\n\nfor item in \u201c${!dict[@]}\u201d\ndo\n    echo \u201c$item =&gt; ${dict[$item]}\u201d\ndone\n</code></pre>"},{"location":"Code/Shell/#dictionnaire","title":"Dictionnaire","text":""},{"location":"Code/Shell/#definition","title":"D\u00e9finition","text":"<p>On d\u00e9clare <code>sound</code> en tant que dictionnaire (couple cl\u00e9:valeur)</p> <pre><code>declare -A sounds\n</code></pre> <pre><code>sounds[dog]=\"bark\"\nsounds[cow]=\"moo\"\nsounds[bird]=\"tweet\"\nsounds[wolf]=\"howl\"\n</code></pre> <pre><code>echo ${sounds[dog]} # Dog's sound\necho ${sounds[@]}   # All values\necho ${!sounds[@]}  # All keys\necho ${#sounds[@]}  # Number of elements\nunset sounds[dog]   # Delete dog\n</code></pre>"},{"location":"Code/Shell/#iteration-sur-les-valeurs","title":"Iteration sur les valeurs","text":"<p><pre><code>for val in \"${sounds[@]}\"; do\n  echo $val\ndone\n</code></pre> </p>"},{"location":"Code/Shell/#iteration-sur-les-cles","title":"Iteration sur les cl\u00e9s","text":"<pre><code>for key in \"${!sounds[@]}\"; do\n  echo $key\ndone\n</code></pre>"},{"location":"Code/Shell/#boucles-loop","title":"Boucles (loop)","text":""},{"location":"Code/Shell/#boucle-simple","title":"Boucle simple","text":"<pre><code>for i in /etc/rc.*; do\n  echo $i\ndone\n</code></pre>"},{"location":"Code/Shell/#boucle-incrementale","title":"Boucle incr\u00e9mentale","text":"<pre><code>for ((i = 0 ; i &lt; 100 ; i++)); do\n  echo $i\ndone\n</code></pre>"},{"location":"Code/Shell/#boucle-range","title":"Boucle \"range\"","text":"<pre><code>for i in {1..5}; do\n    echo \"Welcome $i\"\ndone\n</code></pre>"},{"location":"Code/Shell/#boucle-etape","title":"Boucle \"etape\"","text":"<pre><code>for i in {5..50..5}; do\n    echo \"Welcome $i\"\ndone\n</code></pre>"},{"location":"Code/Shell/#boucle-avec-lecture-read","title":"Boucle avec lecture (read)","text":"<pre><code>cat file.txt | while read line; do\n  echo $line\ndone\n</code></pre>"},{"location":"Code/Shell/#boucle-while","title":"Boucle while","text":"<p><pre><code>while true; do\n  \u00b7\u00b7\u00b7\ndone\n</code></pre> </p>"},{"location":"Code/Shell/#grep","title":"Grep","text":""},{"location":"Code/Shell/#afficher-un-ou-des-process-sans-le-process-grep-himself","title":"Afficher un ou des process sans le process grep himself","text":"<p><pre><code>ps - elf | grep squid | grep -v grep\nou\nps -elf | grep [s]quid\n</code></pre> </p>"},{"location":"Code/Shell/#affichier-un-fichier-sans-les-commentaires","title":"Affichier un fichier sans les commentaires","text":"<p><pre><code>grep -E -v '^(#|$)' &lt;fichier&gt;\nou\negrep -v '^(#|$)' &lt;fichier&gt;\n</code></pre> </p>"},{"location":"Code/Shell/#grep-avec-multiple-patterns","title":"Grep avec multiple patterns","text":"<p><pre><code>egrep -i \"apache|lsyncd\" &lt;file&gt;\nou\ngrep -i -e apache -e lsyncd &lt;file&gt;\n</code></pre> </p>"},{"location":"Code/Shell/#grep-dun-pattern","title":"Grep d'un pattern","text":"<pre><code>if grep -q 'foo' ~/.bash_history; then\n  echo \"You appear to have typed 'foo' in the past\"\nfi\n</code></pre>"},{"location":"Code/Shell/#gestion-des-pipe","title":"Gestion des pipe","text":""},{"location":"Code/Shell/#variable-pipestatus","title":"Variable PIPESTATUS","text":"<p><pre><code>ls toto 2&gt;&amp;1 | tee -a toto.log;\necho ${PIPESTATUS[0]} #RC Avant pipe\necho $? #RC apr\u00e8s pipe\n</code></pre> </p>"},{"location":"Code/Shell/#awk","title":"AWK","text":""},{"location":"Code/Shell/#supprimer-les-caracteres-m","title":"Supprimer les caract\u00e8res ^M","text":"<p><pre><code>awk 'sub(/^M/, \"\");1' &lt;ficsource&gt; &lt;ficmaj&gt;\n</code></pre> </p>"},{"location":"Code/Shell/#afficher-champ-selon-separateur","title":"Afficher champ selon s\u00e9parateur","text":"<pre><code>awk -F\"\\t\"  '{ print $56 }'\n</code></pre> <p>Note</p> <p>Afficher le premier champ de chaque ligne avec tabulation en s\u00e9parateur de champ</p> <p> </p>"},{"location":"Code/Shell/#remplacer-expr-par-awk","title":"Remplacer EXPR par AWK","text":"<p><pre><code>awk 'BEGIN{print 1024 / 1000}'\n</code></pre> </p>"},{"location":"Code/Shell/#selectioner-la-premiere-ou-la-derniere-ligne-imprimer-un-champ","title":"Selectioner la premi\u00e8re ou la derni\u00e8re ligne + imprimer un champ","text":"<p><pre><code>awk 'BEGIN{print $2}'\nawk 'END{print $2}'\n</code></pre> </p>"},{"location":"Code/Shell/#sed","title":"Sed","text":""},{"location":"Code/Shell/#supprimer-les-caracteres-ascii-m","title":"Supprimer les caract\u00e8res ASCII ^M","text":"<p><pre><code>sed 's/^M//g' &lt;ficsource&gt; &lt;ficmaj&gt;\nou\nsed -i 's/^M//g' &lt;ficsource&gt;\n</code></pre> </p>"},{"location":"Code/Shell/#critere-de-recherche","title":"Crit\u00e8re de recherche","text":"<p><pre><code>sed -e \" //{N;s/Hxxxxx/Pxxxxx/g;} \"\\\n</code></pre> </p>"},{"location":"Code/Shell/#supprimer-les-caracteres-newline-lf","title":"Supprimer les caract\u00e8res \"Newline\" (LF)","text":"<p><pre><code>sed -i '{:q;N;s/\\n//g;t q}' days.txt\n</code></pre> </p>"},{"location":"Code/Shell/#supprimer-les-10-premiers-caracteres-de-chaque-ligne","title":"Supprimer les 10 premiers caract\u00e8res de chaque ligne","text":"<p><pre><code>sed -i 's/^.\\{10\\}//g' fichier.txt\n</code></pre> </p>"},{"location":"Code/Shell/#affichier-une-ligne-en-particulier","title":"Affichier une ligne en particulier","text":"<pre><code>&lt;code&gt;sed -n 1p check_toto.txt\n</code></pre> <p>Note</p> <p>Ici la premi\u00e8re ligne</p> <p> </p>"},{"location":"Code/Shell/#savoir-si-une-variable-est-numerique","title":"Savoir si une variable est num\u00e9rique","text":"<p><pre><code>if [ -n \"$(echo $var | sed 's/[0-9]//g')\" ]; then\n    echo 'is not numeric'\nelse\n    echo 'is numeric'\nfi\n</code></pre> </p>"},{"location":"Code/Shell/#basename","title":"Basename","text":""},{"location":"Code/Shell/#lister-les-fichiers-sans-extensions","title":"Lister les fichiers sans extensions","text":"<p><pre><code>for i in \"$@\"; \ndo\nBN=$(basename \"${i%.*}\")\n ...\ndone\n</code></pre> </p>"},{"location":"Code/Shell/#directory-of-script","title":"Directory of script","text":"<pre><code>DIR=\"$(readlink -f \"$(dirname \"$0\")/../data/transfers\")\"\n</code></pre> <p>readlink permet le suivi des liens</p> <p> </p>"},{"location":"Code/Shell/#afficher-le-nom-du-script-execute","title":"Afficher le nom du script ex\u00e9cut\u00e9","text":"<p><code>Le script $(basename ${0}) est correctement ex\u00e9cut\u00e9</code> </p>"},{"location":"Code/Shell/#find","title":"Find","text":""},{"location":"Code/Shell/#renommer-lextension-de-plusieurs-fichiers","title":"Renommer l'extension de plusieurs fichiers","text":"<p><pre><code>find . -name '*.mp4' | rename mp4 txt *\n</code></pre> </p>"},{"location":"Code/Shell/#recherche-recursive-avec-mot-cle","title":"Recherche r\u00e9cursive avec \"mot-cl\u00e9\"","text":"<p><pre><code>find / -xdev -type f -exec grep -i toto {} /dev/null \\;\n</code></pre> </p> <p>Note</p> <p>recherche r\u00e9cursive de tous les fichiers qui contiennent le mot \u00ab toto \u00bb (ou TOTO\u2026 ou ToTo\u2026)</p> <p>Warning</p> <p>Attention : \u00ab \\; \u00bb obligatoire \u00e0 la fin de la commande</p> <p>Info</p> <p>N.B : L\u2019option xdev permet de ne pas franchir les limites du systeme de fichiers</p> <p> </p>"},{"location":"Code/Shell/#purge-de-fichiers","title":"Purge de fichiers","text":"<pre><code>find . -type f -mtime +7 -name \u00ab *.trc \u00bb -exec rm -f {} \\;\nfind . -type f -mtime +2 -size xx -exec rm {}; avec xx = 10M ou 10K par ex \nfind . -type f -mtime +2 -name /*/backup/*/ -exec rm {};  (enlever les / )\nfind . -type f -mtime +1 -exec rm\n</code></pre>"},{"location":"Code/Shell/#recherche-mot-cle-avec-redirection-log","title":"Recherche \"mot-cl\u00e9\" avec redirection log","text":"<pre><code>find . -type f -print | xargs grep -i \u00ab my_string_to_search \u00bb&gt; /tmp/search.log 2&gt;/dev/null;\n</code></pre>"},{"location":"Code/Shell/#recherche-des-fichiers-sans-arborescence-repertoire","title":"Recherche des fichiers sans arborescence r\u00e9pertoire","text":"<pre><code>find . -name '*.txt' -exec basename {} \\;\n</code></pre>"},{"location":"Code/Shell/#test","title":"Test","text":""},{"location":"Code/Shell/#condition-dexecution","title":"Condition d'execution","text":"<pre><code>git commit &amp;&amp; git push\ngit commit || echo \"Commit failed\"\n</code></pre> <pre><code>if [[ -z \"$string\" ]]; then\n  echo \"String is empty\"\nelif [[ -n \"$string\" ]]; then\n  echo \"String is not empty\"\nfi\n</code></pre> Condition Description <code>[[ -z STRING ]]</code> Empty string <code>[[ -n STRING ]]</code> Not empty string <code>[[ STRING == STRING ]]</code> Equal <code>[[ STRING != STRING ]]</code> Not Equal --- --- <code>[[ NUM -eq NUM ]]</code> Equal <code>[[ NUM -ne NUM ]]</code> Not equal <code>[[ NUM -lt NUM ]]</code> Less than <code>[[ NUM -le NUM ]]</code> Less than or equal <code>[[ NUM -gt NUM ]]</code> Greater than <code>[[ NUM -ge NUM ]]</code> Greater than or equal --- --- <code>[[ STRING =~ STRING ]]</code> Regexp --- --- <code>(( NUM &lt; NUM ))</code> Numeric conditions"},{"location":"Code/Shell/#more-conditions","title":"More conditions","text":"Condition Description <code>[[ -o noclobber ]]</code> If OPTIONNAME is enabled --- --- <code>[[ ! EXPR ]]</code> Not <code>[[ X &amp;&amp; Y ]]</code> And <code>[[ X || Y ]]</code> Or"},{"location":"Code/Shell/#file-conditions","title":"File conditions","text":"Condition Description <code>[[ -e FILE ]]</code> Exists <code>[[ -r FILE ]]</code> Readable <code>[[ -h FILE ]]</code> Symlink <code>[[ -d FILE ]]</code> Directory <code>[[ -w FILE ]]</code> Writable <code>[[ -s FILE ]]</code> Size is &gt; 0 bytes <code>[[ -f FILE ]]</code> File <code>[[ -x FILE ]]</code> Executable --- --- <code>[[ FILE1 -nt FILE2 ]]</code> 1 is more recent than 2 <code>[[ FILE1 -ot FILE2 ]]</code> 2 is more recent than 1 <code>[[ FILE1 -ef FILE2 ]]</code> Same files"},{"location":"Code/Shell/#example","title":"Example","text":"<pre><code># String\nif [[ -z \"$string\" ]]; then\n  echo \"String is empty\"\nelif [[ -n \"$string\" ]]; then\n  echo \"String is not empty\"\nelse\n  echo \"This never happens\"\nfi\n</code></pre> <pre><code># Combinations\nif [[ X &amp;&amp; Y ]]; then\n  ...\nfi\n</code></pre> <pre><code># Equal\nif [[ \"$A\" == \"$B\" ]]\n</code></pre> <pre><code># Regex\nif [[ \"A\" =~ . ]]\n</code></pre> <pre><code>if (( $a &lt; $b )); then\n   echo \"$a is smaller than $b\"\nfi\n</code></pre> <pre><code>if [[ -e \"file.txt\" ]]; then\n  echo \"file exists\"\nfi\n</code></pre>"},{"location":"Code/Shell/#fonctions","title":"Fonctions","text":""},{"location":"Code/Shell/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<pre><code>log_and_die() {\n  &gt;&amp;2 echo \"[FATAL] $*\"\n  exit 1\n}\n</code></pre>"},{"location":"Database/DB2/","title":"DB2","text":""},{"location":"Database/DB2/#db2-en-vrac","title":"DB2 en vrac","text":""},{"location":"Database/DB2/#logs-db2","title":"Logs DB2","text":"<p><pre><code>/home/sqllib/db2dump/db2diag.log\n</code></pre> </p>"},{"location":"Database/DB2/#derniere-sauvegarde-full","title":"Derniere sauvegarde FULL","text":"<pre><code>db2adutl query database &lt;DB&gt; full \n</code></pre> <p>Depuis un serveur distant</p> <p>db2adutl query full db  nodename  owner ` <p> </p>"},{"location":"Database/DB2/#recuperer-lhistorique-pour-lensemble-dune-db","title":"Recup\u00e9rer l'historique pour l'ensemble d'une DB","text":"<p><pre><code>db2 list history backup all for db &lt;DB&gt;\n</code></pre> </p>"},{"location":"Database/DB2/#recuperer-lhistorique-depuis-un-point-dans-le-temps","title":"R\u00e9cup\u00e9rer l'historique depuis un point dans le temps","text":"<p><pre><code>db2 list history BACKUP since 20120101 for db mydb \n</code></pre> </p>"},{"location":"Database/DB2/#appliquer-un-grant-user-sur-une-db-qui-ne-lui-appartient-pas","title":"Appliquer un grant user sur une DB qui ne lui appartient pas","text":"<pre><code>db2adutl grant user &lt;USER&gt; on nodename &lt;SRV_CIBLE&gt; for db &lt;DB_CIBLE&gt;\n</code></pre>"},{"location":"Database/DB2/#rollfoward-pending","title":"Rollfoward pending","text":"<p>Note</p> <p>il se peut que lors d'un refresh de base DB2, des logs DB2 existe sur l'environnemnt cible et que celles-ci soient confondus avec les logs de la base source. Dans ce cas pr\u00e9sent, le plus simple \u00e9tant de supprimer totalement les logs db2 encore pr\u00e9sent sur l'environnement cible</p> <p>Exemple de suppression des fichiers de logs</p> <pre><code>db2adutl query logs chain 2 database &lt;DB&gt;\ndb2adutl delete logs chain 2 database &lt;DB&gt; without prompting\n</code></pre> <p> Exemple de suppression d'une liste de fichiers de logs <pre><code>db2adutl delete logs between S0000282 and S0000292 database &lt;DB&gt;\n</code></pre></p>"},{"location":"Database/Oracle/","title":"Oracle","text":""},{"location":"Database/Oracle/#requete-user","title":"Requ\u00eate user","text":""},{"location":"Database/Oracle/#lister-les-schema-dune-base","title":"Lister les sch\u00e9ma d'une base","text":"<p><pre><code>select distinct owner from dba_objects where owner like '%&lt;string_to_search&gt;%';\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-usernames-dune-base","title":"Lister les usernames d'une base","text":"<p><pre><code>select username from all_users where username like '%&lt;string_to_search&gt;%';\n</code></pre> </p>"},{"location":"Database/Oracle/#dropper-un-schema","title":"Dropper un sch\u00e9ma","text":"<p><pre><code>Drop user \"&amp;user\" cascade;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-schemas-dune-base","title":"Lister les sch\u00e9mas d'une base","text":"<pre><code>select distinct owner from dba_objects where owner like '%&lt;string_to_search&gt;%';\n</code></pre>"},{"location":"Database/Oracle/#killer-une-session","title":"Killer une session","text":"<p><pre><code>ALTER SYSTEM KILL SESSION 'sid,serial#' IMMEDIATE;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-comptes-verouillles","title":"Lister les comptes v\u00e9rouilll\u00e9s","text":"<p><pre><code>set linesize 300\nCOL \"USERNAME\" FORMAT A15\nCOL \"ACCOUNT_STATUS\" FORMAT A20\nCOL \"CREATED\" FORMAT A10\nSELECT username, account_status, created, lock_date, expiry_date, profile\nFROM dba_users\nWHERE account_status != 'OPEN';\n\nset linesize 300\nCOL \"USERNAME\" FORMAT A15\nCOL \"ACCOUNT_STATUS\" FORMAT A20\nCOL \"CREATED\" FORMAT A10\nselect username, account_status, profile, created, lock_date,EXPIRY_DATE, round(EXPIRY_DATE - SYSDATE) nb_jour_avant_expiration\nfrom   dba_users\norder by nb_jour_avant_expiration;\n</code></pre> </p>"},{"location":"Database/Oracle/#changer-le-mdp-dun-utilisateur","title":"Changer le MDP d'un utilisateur","text":"<p><pre><code>alter user &lt;user&gt; identified by &lt;new_password&gt;;\n</code></pre> </p>"},{"location":"Database/Oracle/#deverouiller-un-compte-utilisateur","title":"D\u00e9verouiller un compte utilisateur","text":"<p><pre><code>alter user &lt;user&gt; account unlock;\n</code></pre> </p>"},{"location":"Database/Oracle/#gestion-des-profiles-oracle","title":"Gestion des profiles oracle","text":"<p><pre><code>COL \"PROFILE\" FORMAT A15\nCOL \"RESOURCE_NAME\" FORMAT A30\nCOL \"RESOURCE_TYPE\" FORMAT A15\nCOL \"LIMIT\" FORMAT A15\nselect * from dba_profiles\n</code></pre> </p>"},{"location":"Database/Oracle/#connaitre-mon-utilisateur-et-schema-actuel","title":"Connaitre mon utilisateur et sch\u00e9ma actuel","text":"<p><pre><code>select sys_context('USERENV','SESSION_USER') current_user, sys_context('USERENV','SESSION_SCHEMA') current_schema from dual;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-sessions-active","title":"Lister les sessions active","text":"<p><pre><code>set echo off\nset feed off\nset linesize 512\n\ncolumn machine format a20\ncolumn osuser format a10\ncolumn module format a30\n\nSELECT machine,process,osuser,username,schemaname,status,lockwait,sid,serial#,module,action FROM v$session\nWHERE username is not null\nAND osuser is not null\nAND STATUS != 'INACTIVE'\nORDER BY machine,osuser,username,schemaname,status,module;\n</code></pre> </p>"},{"location":"Database/Oracle/#affichier-les-verrous","title":"Affichier les verrous","text":"<p><pre><code>SET echo off\n    SET feedback off\n    SET linesize 512\n\n    prompt -----------------------\n    prompt - Verrous sur la base -\n    prompt -----------------------\n\n    COLUMN sid format 999 heading \"SID\"\n    COLUMN username format a10 heading \"Utilisateur\"\n    COLUMN machine format a20 heading \"Nom Machine\"\n    COLUMN object_name format a20 heading \"Nom objet\"\n    COLUMN type format a4 heading \"Type\"\n    COLUMN lmode format a20 heading \"Mode de verrouillage\"\n    COLUMN request format 9999999 heading \"Request Mode\"\n    COLUMN block format 9999999 heading \"Lock Blocking\"\n\n    SELECT\n    s.sid sid,\n    s.username username,\n    s.machine machine,\n    l.type type,\n    o.object_name object_name,\n    DECODE(l.lmode,\n    0,'None',\n    1,'Null',\n    2,'Row Share',\n    3,'Row Exlusive',\n    4,'Share',\n    5,'Sh/Row Exlusive',\n    6,'Exclusive') lmode,\n    DECODE(l.request,\n    0,'None',\n    1,'Null',\n    2,'Row Share',\n    3,'Row Exlusive',\n    4,'Share',\n    5,'Sh/Row Exlusive',\n    6,'Exclusive') request,\n    l.block block\n    FROM\n    v$lock l,\n    v$session s,\n    dba_objects o\n    WHERE\n    l.sid = s.sid\n    AND\n    username != 'SYSTEM'\n    AND\n    o.object_id(+) = l.id1; \n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-roles-dun-utilisateur","title":"Lister les r\u00f4les d'un utilisateur","text":"<p><pre><code>COL \"Utilisateur\" FORMAT A25\nCOL \"Roles\" FORMAT A25        \nSELECT grantee \"Utilisateur\",\ngranted_role \"Roles\",\nadmin_option\nFROM dba_role_privs\nWHERE grantee = '&amp;1'\nUNION\n   SELECT  grantee \"Utilisateur\",\n   granted_role \"Roles\",\n   admin_option\n   FROM dba_role_privs\n   WHERE  grantee in (SELECT granted_role\n                      FROM DBA_ROLE_PRIVS\n                      WHERE grantee = '&amp;1');\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-privileges-dun-role","title":"Lister les privil\u00e8ges d'un r\u00f4le","text":"<p><pre><code>COL \"Roles\" FORMAT A25\nCOL \"Privilege Systeme\" FORMAT A40\nSELECT grantee \"Roles\" ,\nPrivilege \"Privilege Systeme\",\nadmin_option\nFROM dba_sys_privs\nWHERE grantee in (SELECT granted_role\n                  FROM dba_role_privs\n                  WHERE grantee = '&amp;1'\n                  UNION\n                  SELECT granted_role\n                  FROM dba_role_privs\n                  WHERE grantee in (SELECT granted_role\n                  FROM DBA_ROLE_PRIVS\n                  WHERE grantee = '&amp;1'))\n                  ORDER BY 1 DESC;\n</code></pre> </p>"},{"location":"Database/Oracle/#trigger","title":"Trigger","text":""},{"location":"Database/Oracle/#generer-ordre-de-suppression-trigger","title":"G\u00e9n\u00e9rer ordre de suppression trigger","text":"<p><pre><code>Select 'drop trigger ' || trigger_name || ';' stmt from user_triggers;\n</code></pre> </p>"},{"location":"Database/Oracle/#tablespace","title":"Tablespace","text":""},{"location":"Database/Oracle/#lister-les-tablespaces-par-defaut-dun-user-sysdba","title":"Lister les tablespaces par d\u00e9faut d'un user (sysdba)","text":"<p><pre><code>select username,default_tablespace from dba_users where default_tablespace='TOOLS';\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-tablespaces-par-defaut-dun-user","title":"Lister les tablespaces par d\u00e9faut d'un user","text":"<p><pre><code>select default_tablespace from user_users;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-tablespaces-taille-alloue-occupe-libre","title":"Lister les tablespaces + taille (Allou\u00e9 - occup\u00e9 - libre)","text":"<p><pre><code>clear breaks\nclear computes\nclear columns\nset pagesize 50\nset linesize 120\nset heading on\ncolumn tablespace_name heading 'Tablespace' justify left format a20 truncated\ncolumn tbsize heading 'Size (Mb) ' justify left format 9,999,999.99\ncolumn tbused heading 'Used (Mb) ' justify right format 9,999,999.99\ncolumn tbfree heading 'Free (Mb) ' justify right format 9,999,999.99\ncolumn tbusedpct heading 'Used % ' justify left format a8\ncolumn tbfreepct heading 'Free % ' justify left format a8\nbreak on report\ncompute sum label 'Totals:' of tbsize tbused tbfree on report\nselect t.tablespace_name, round(a.bytes,2) tbsize,\nnvl(round(c.bytes,2),'0') tbfree,\nnvl(round(b.bytes,2),'0') tbused,\nto_char(round(100 * (nvl(b.bytes,0)/nvl(a.bytes,1)),2)) || '%' tbusedpct,\nto_char(round(100 * (nvl(c.bytes,0)/nvl(a.bytes,1)),2)) || '%' tbfreepct\nfrom dba_tablespaces t,\n(select tablespace_name, round(sum(bytes)/1024/1024,2) bytes\nfrom dba_data_files\ngroup by tablespace_name\nunion\nselect tablespace_name, round(sum(bytes)/1024/1024,2) bytes\nfrom dba_temp_files\ngroup by tablespace_name ) a,\n(select e.tablespace_name, round(sum(e.bytes)/1024/1024,2) bytes\nfrom dba_segments e\ngroup by e.tablespace_name\nunion\nselect tablespace_name, sum(max_size) bytes\nfrom v$sort_segment\ngroup by tablespace_name) b,\n(select f.tablespace_name, round(sum(f.bytes)/1024/1024,2) bytes\nfrom dba_free_space f\ngroup by f.tablespace_name\nunion\nselect tmp.tablespace_name, (sum(bytes/1024/1024) - sum(max_size)) bytes\nfrom dba_temp_files tmp, v$sort_segment sort\nwhere tmp.tablespace_name = sort.tablespace_name\ngroup by tmp.tablespace_name) c\nwhere\nt.tablespace_name = a.tablespace_name (+)\nand t.tablespace_name = b.tablespace_name (+)\nand t.tablespace_name = c.tablespace_name (+)\norder by t.tablespace_name;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-tablespaces-fichier-et-status","title":"Lister les tablespaces + fichier et status","text":"<p><pre><code>set linesize 200\nCOL \"STATUS\" FORMAT A10\nCOL \"TABLESPACE_NAME\" FORMAT A20\nCOL \"FILE_NAME\" FORMAT A80\nSELECT \nFILE_ID, STATUS, TABLESPACE_NAME, FILE_NAME\nFROM \nDBA_DATA_FILES\nORDER BY FILE_ID; \n</code></pre> </p>"},{"location":"Database/Oracle/#supprimer-un-tablespace","title":"Supprimer un tablespace","text":"<p><pre><code>ALTER DATABASE DATAFILE '&lt;filename&gt;' OFFLINE DROP;\nDROP TABLESPACE &lt;TableSpace&gt;;\n</code></pre> </p>"},{"location":"Database/Oracle/#verifier-le-contenu-du-tablespace-sysaux","title":"V\u00e9rifier le contenu du tablespace SYSAUX","text":"<p><pre><code>select occupant_desc, space_usage_kbytes/1024 as usage_GB from v$sysaux_occupants where space_usage_kbytes &gt; 0 order by space_usage_kbytes desc;\n</code></pre> </p>"},{"location":"Database/Oracle/#savoir-si-un-tablespace-est-en-autoextend","title":"Savoir si un tablespace est en \"Autoextend\"","text":"<p><pre><code>select tablespace_name, file_name ,AUTOEXTENSIBLE,MAXBYTES,INCREMENT_BY from dba_data_files order by 1,2;\n</code></pre> </p>"},{"location":"Database/Oracle/#voir-qui-utilise-le-tablespace-temp","title":"Voir qui utilise le tablespace TEMP","text":"<pre><code>select * from v$sort_usage;\n</code></pre>"},{"location":"Database/Oracle/#tables","title":"Tables","text":""},{"location":"Database/Oracle/#lister-les-tables-dun-schema","title":"Lister les tables d'un sch\u00e9ma","text":"<p>==&gt; D'un utilisateur lambda <pre><code>SELECT DISTINCT OWNER,TABLE_NAME FROM all_tab_columns WHERE OWNER = \u2018E_CTM\u2019;\n</code></pre> ==&gt; D'un utilisateur syst\u00e8me <pre><code>SELECT DISTINCT OWNER,TABLE_NAME FROM dba_tab_columns WHERE OWNER = \u2018E_CTM\u2019;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-tables-dun-utilisateur","title":"Lister les tables d'un utilisateur","text":"<pre><code>SELECT table_name FROM user_tables;\nSELECT table_name FROM all_tables;\n</code></pre> <p>all_tables : incluant les tables syst\u00e8me (n\u00e9c\u00e9ssite les droits DBA)</p> <p> </p>"},{"location":"Database/Oracle/#compter-le-nombre-de-tables-dun-schema","title":"Compter le nombre de tables d'un sch\u00e9ma","text":"<p><pre><code>Select count(*), owner FROM ALL_TABLES group by owner;\n</code></pre> </p>"},{"location":"Database/Oracle/#vider-une-table","title":"Vider une table","text":"<p>==&gt; Un ou plusieurs champs <pre><code>Delete from [table] where ID = \u2018kkechose\u2019 ;\n</code></pre> ==&gt; Une table <pre><code>Truncate table [schema].[table];\n</code></pre></p> <p>Si le message suivant apparait :</p> <p>ORA-02266: les cl\u00e9s primaires/uniques de la table sont r\u00e9f\u00e9renc\u00e9es par des cl\u00e9s \u00e9trang\u00e8res</p> <p>ajouter : <pre><code>DROP PRIMARY KEY CASCADE;\n</code></pre> </p>"},{"location":"Database/Oracle/#supprimer-une-table","title":"Supprimer une table","text":"<pre><code>Drop table [table] cascade constraints purge;\n</code></pre> <p>purge = pas possible de faire un rollback sur la table = suppression d\u00e9finitive</p> <p> </p>"},{"location":"Database/Oracle/#generer-ordre-sql-grant-table","title":"G\u00e9n\u00e9rer ordre SQL \"Grant Table\"","text":"<p><pre><code>select 'GRANT SELECT ON '||owner||'.'||table_name||' to role' from all_tables where owner='user';\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-colonnes-dune-table","title":"Lister les colonnes d'une table","text":"<p><pre><code>SELECT COLUMN_NAME FROM USER_TAB_COLUMNS WHERE TABLE_NAME='CONFIGURATION';\n</code></pre> </p>"},{"location":"Database/Oracle/#sauvegarderestauration-rman","title":"Sauvegarde/Restauration RMAN","text":""},{"location":"Database/Oracle/#connaitre-les-bases-listes-sur-rman","title":"Connaitre les bases list\u00e9s sur RMAN","text":"<p><pre><code>set linesize 1000\nselect * from rman.rc_database order by NAME;\n</code></pre> </p>"},{"location":"Database/Oracle/#restauration-des-archivelogs-a-partir-dun-backup-rman","title":"Restauration des archivelogs \u00e0 partir d'un backup RMAN","text":"<p><pre><code>rman target /\n\nRUN\n{\n    ALLOCATE CHANNEL t1 DEVICE TYPE disk;\n    set archivelog destination to '/appli/oracle/PCONAT/oraarch/';\n    restore archivelog from logseq 3490 until logseq 3495;\n    release channel t1;\n}\n</code></pre> </p>"},{"location":"Database/Oracle/#supprimer-des-archlogs-depuis-rman","title":"Supprimer des archlogs depuis RMAN","text":"<pre><code>export ORACLE_SID=XXX ; rman target /\ncrosscheck archivelog all; # v\u00e9rifier les aarchlogs connus depuis les controlfiles\ndelete noprompt expired archivelog all;  # Expir\u00e9\ndelete noprompt archivelog until time \u2018SYSDATE-10\u2019; # depuis une date pr\u00e9cise\ndelete noprompt obsolete; \ndelete archivelog all backed up 1 times to disk completed before 'sysdate - 4/24';\n</code></pre> <p>Pour cette derni\u00e8re commande <code>delete</code> , supprimer les archlogs g\u00e9n\u00e9r\u00e9s depuis les 4 derni\u00e8res heure et sauvegard\u00e9 au moins une fois sur disque</p> <p> </p>"},{"location":"Database/Oracle/#connaitre-la-quantite-darchlogs-genere-par-jour","title":"Connaitre la quantit\u00e9 d'archlogs g\u00e9n\u00e9r\u00e9 par jour","text":"<p><pre><code>  SELECT SUM_ARCH.DAY,\n         SUM_ARCH.GENERATED_MB,\n         SUM_ARCH_DEL.DELETED_MB,\n         SUM_ARCH.GENERATED_MB - SUM_ARCH_DEL.DELETED_MB \"REMAINING_MB\"\n    FROM (  SELECT TO_CHAR (COMPLETION_TIME, 'DD/MM/YYYY') DAY,\n                   SUM (ROUND ( (blocks * block_size) / (1024 * 1024), 2))\n                      GENERATED_MB\n              FROM V$ARCHIVED_LOG\n             WHERE ARCHIVED = 'YES'\n          GROUP BY TO_CHAR (COMPLETION_TIME, 'DD/MM/YYYY')) SUM_ARCH,\n         (  SELECT TO_CHAR (COMPLETION_TIME, 'DD/MM/YYYY') DAY,\n                   SUM (ROUND ( (blocks * block_size) / (1024 * 1024), 2))\n                      DELETED_MB\n              FROM V$ARCHIVED_LOG\n             WHERE ARCHIVED = 'YES' AND DELETED = 'YES'\n          GROUP BY TO_CHAR (COMPLETION_TIME, 'DD/MM/YYYY')) SUM_ARCH_DEL\n   WHERE SUM_ARCH.DAY = SUM_ARCH_DEL.DAY(+)\nORDER BY TO_DATE (DAY, 'DD/MM/YYYY');\n</code></pre> </p>"},{"location":"Database/Oracle/#connaitre-le-nombre-darchlogs-genere-par-heure-chaque-jour","title":"Connaitre le nombre d'archlogs g\u00e9n\u00e9r\u00e9 par heure chaque jour","text":"<p><pre><code> SELECT TO_CHAR (COMPLETION_TIME, 'DD/MM/YYYY') DAY,\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '00', 1, NULL))\n            \"00-01\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '01', 1, NULL))\n            \"01-02\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '02', 1, NULL))\n            \"02-03\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '03', 1, NULL))\n            \"03-04\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '04', 1, NULL))\n            \"04-05\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '05', 1, NULL))\n            \"05-06\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '06', 1, NULL))\n            \"06-07\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '07', 1, NULL))\n            \"07-08\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '08', 1, NULL))\n            \"08-09\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '09', 1, NULL))\n            \"09-10\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '10', 1, NULL))\n            \"10-11\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '11', 1, NULL))\n            \"11-12\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '12', 1, NULL))\n            \"12-13\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '13', 1, NULL))\n            \"13-14\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '14', 1, NULL))\n            \"14-15\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '15', 1, NULL))\n            \"15-16\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '16', 1, NULL))\n            \"16-17\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '17', 1, NULL))\n            \"17-18\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '18', 1, NULL))\n            \"18-19\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '19', 1, NULL))\n            \"19-20\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '20', 1, NULL))\n            \"20-21\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '21', 1, NULL))\n            \"21-22\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '22', 1, NULL))\n            \"22-23\",\n         SUM (DECODE (TO_CHAR (COMPLETION_TIME, 'HH24'), '23', 1, NULL))\n            \"23-00\",\n         COUNT (*) TOTAL\n    FROM V$ARCHIVED_LOG\nWHERE ARCHIVED='YES'\nGROUP BY TO_CHAR (COMPLETION_TIME, 'DD/MM/YYYY')\nORDER BY TO_DATE (DAY, 'DD/MM/YYYY');\n</code></pre> </p>"},{"location":"Database/Oracle/#datapump","title":"Datapump","text":""},{"location":"Database/Oracle/#realiser-un-export-datapump","title":"R\u00e9aliser un export DATAPUMP","text":"<pre><code>expdp \\\"/ as sysdba\\\" SCHEMAS=metier DIRECTORY=DATA_PUMP_DIR DUMPFILE=metier.dmp LOGFILE=metier.log\n</code></pre>"},{"location":"Database/Oracle/#realiser-un-import-datapump","title":"R\u00e9aliser un import DATAPUMP","text":"<pre><code>impdp \\\"/ as sysdba\\\" SCHEMAS=metier DIRECTORY=DATA_PUMP_DIR DUMPFILE=metier.dmp LOGFILE=metier.log\n</code></pre>"},{"location":"Database/Oracle/#import-avec-remap-schema","title":"Import avec remap sch\u00e9ma","text":"<pre><code>impdp \\\"/ as sysdba\\\" SCHEMAS=MGNADMF DIRECTORY=DATAPUMP DUMPFILE=MGNNATfull20160624.dmp LOGFILE=impdp_IQ_MGNNAT_MGNRW_280616.log REMAP_SCHEMA=MGNADMF:MGNRW\n</code></pre> <p>Options Possible : <code>TABLE_EXISTS_ACTION = SKIP | APPEND | TRUNCATE | REPLACE</code></p> <p> </p>"},{"location":"Database/Oracle/#purger-les-donnees-dun-schema","title":"Purger les donn\u00e9es d'un sch\u00e9ma","text":"<pre><code>select 'DROP '||OBJECT_TYPE||' '||OWNER||'.'||OBJECT_NAME||';' from dba_objects where owner='GAGCVEILLE' and OBJECT_TYPE&lt;&gt;'INDEX';\n</code></pre>"},{"location":"Database/Oracle/#purger-la-corbeille","title":"Purger la corbeille","text":"<pre><code>purge dba_recyclebin;\n</code></pre>"},{"location":"Database/Oracle/#gestion-du-directory-datapump","title":"Gestion du directory DATAPUMP","text":"<pre><code>create or replace directory as 'G:\\..\\..';\n\nGRANT read, write ON DIRECTORY to ;\n\ndrop directory '.....' ;\n</code></pre>"},{"location":"Database/Oracle/#monitorer-les-jobs-datapump","title":"Monitorer les jobs DATAPUMP","text":"<p><pre><code>COL OWNER_NAME FORMAT A11\nCOL JOB_NAME FORMAT A20\nCOL OPERATION FORMAT A11\nCOL JOB_MODE FORMAT A9\nCOL STATE FORMAT A12\nSET LINESIZE 120\n\nSelect * FROM DBA_DATAPUMP_JOBS;\n</code></pre> ou <pre><code>set lines 200\ncol owner_name format a10;\ncol state format a11\ncol operation like state\ncol job_mode like state\n\nselect owner_name, job_name, operation, job_mode, state, attached_sessions\nfrom dba_datapump_jobs\nwhere job_name not like 'BIN$%'\norder by 1,2;\n</code></pre></p> <p> </p>"},{"location":"Database/Oracle/#killer-les-jobs-datapump","title":"Killer les jobs DATAPUMP","text":"<pre><code>PENDANT\n&lt;code sql&gt;\nCTRL-C\nstop_job=immediate\nyes\n\n\nAPRES\n&lt;code sql&gt;\nset serveroutput on\nset lines 100\ndeclare\nh1 number;\nbegin\n\u2014 Format: dbms_datapump.attach('[job_name]','[owner_name]');\nh1 := dbms_datapump.attach('SYS_EXPORT_SCHEMA_01','SYS');\ndbms_datapump.stop_job (h1,1,0);\nend;\n/\n</code></pre>"},{"location":"Database/Oracle/#dropper-les-jobs-datapump-inutile","title":"Dropper les jobs DATAPUMP inutile","text":"<pre><code>DROP TABLE SYS.SYS_IMPORT_FULL_01;\nDROP TABLE SYS.SYS_EXPORT_FULL_01;\nDROP TABLE SYS.SYS_IMPORT_SCHEMA_01;\nDROP TABLE SYS.SYS_EXPORT_SCHEMA_01;\n</code></pre>"},{"location":"Database/Oracle/#monter-un-partage-cifs-pour-export-datapump","title":"Monter un partage CIFS pour export DATAPUMP","text":"<pre><code>mount.cifs //stock-ora/oradump$/RepDump /mnt/share --verbose -ouser=&lt;user&gt;,pass=&lt;pass&gt;,auto,uid=oracle,gid=dba 0 0\n\n          DISTANT                      LOCAL\n</code></pre>"},{"location":"Database/Oracle/#voir-le-transfert-pendant-lexport-ou-limport-avec-le-user-sys","title":"Voir le transfert pendant l'export ou l'import (avec le user SYS)","text":"<pre><code>select sid, serial#, username, program, module, event, seconds_in_wait from v$session where username = 'SYS';\n</code></pre>"},{"location":"Database/Oracle/#dataguard","title":"Dataguard","text":""},{"location":"Database/Oracle/#verifier-la-bonne-replication-des-archlogs","title":"V\u00e9rifier la bonne r\u00e9plication des archlogs","text":"<p>==&gt; Sur le serveur primaire <pre><code>SELECT THREAD#, SEQUENCE#, ARCHIVED, APPLIED FROM V$ARCHIVED_LOG WHERE RECID IN (SELECT MAX(RECID) FROM V$ARCHIVED_LOG);\n</code></pre> ==&gt; Sur le serveur de secours <pre><code>SELECT ARCH.THREAD# \"THREAD\", ARCH.SEQUENCE# \"LAST_RECEIVED\",\nAPPL.SEQUENCE# \"LAST_APPLIED\", (ARCH.SEQUENCE# - APPL.SEQUENCE#) \"DIFFERENCE\"\nFROM\n(SELECT THREAD# ,SEQUENCE# FROM V$ARCHIVED_LOG WHERE (THREAD#,FIRST_TIME ) IN\n(SELECT THREAD#,MAX(FIRST_TIME) FROM V$ARCHIVED_LOG GROUP BY THREAD#)) ARCH,\n(SELECT THREAD# ,SEQUENCE# FROM V$LOG_HISTORY WHERE (THREAD#,FIRST_TIME ) IN\n(SELECT THREAD#,MAX(FIRST_TIME) FROM V$LOG_HISTORY GROUP BY THREAD#)) APPL\nWHERE ARCH.THREAD# = APPL.THREAD#\nORDER BY 1;\n</code></pre> </p>"},{"location":"Database/Oracle/#verifier-letat-des-process-darchivage-sur-la-stanby-mrp0-ou-sur-le-primaire-lgwr","title":"V\u00e9rifier l'\u00e9tat des process d'archivage sur la stanby (MRP0) ou sur le primaire (LGWR)","text":"<p><pre><code>select process,status,sequence# from v$managed_standby where process='LGWR'or process='MRP0';\n</code></pre> </p>"},{"location":"Database/Oracle/#information-membre-dataguard","title":"Information membre dataguard","text":"<p><pre><code>set linesize 200\nSELECT DATABASE_ROLE, DB_UNIQUE_NAME INSTANCE, OPEN_MODE,\nPROTECTION_MODE, PROTECTION_LEVEL, SWITCHOVER_STATUS\nFROM V$DATABASE;\n</code></pre> </p>"},{"location":"Database/Oracle/#message-du-status-dataguard","title":"Message du status Dataguard","text":"<p><pre><code>set linesize 150\nCOL \"MESSAGE\" FORMAT 50\nSELECT ERROR_CODE, MESSAGE  FROM V$DATAGUARD_STATUS;\n</code></pre> </p>"},{"location":"Database/Oracle/#verifier-quil-ny-a-aucun-gap","title":"V\u00e9rifier qu'il n'y a aucun GAP","text":"<p><pre><code>select * from v$archive_gap;\n</code></pre> </p>"},{"location":"Database/Oracle/#relancer-la-replication-des-archlogs-sur-la-standby","title":"Relancer la r\u00e9plication des archlogs sur la STANDBY","text":"<p><pre><code>ARRET\nalter database recover managed standby database cancel;\n\nRELANCE\nalter database recover managed standby database using current logfile disconnect from session;\n</code></pre> </p>"},{"location":"Database/Oracle/#faire-un-switchover-sans-broker-primaire-puis-standby","title":"Faire un \"switchover\" sans broker (primaire puis standby)","text":"<p><pre><code>//Sur le PRIMAIRE\nalter database commit to switchover to physical standby with session shutdown;\nshutdown immediate;\nstartup nomount;\nalter database mount standby database;\nalter database recover managed standby database disconnect from session;\n\n//Sur le STANDBY\n&lt;code sql&gt;\nalter database recover managed standby database cancel;\nalter database commit to switchover to primary with session shutdown;\nalter database open;\nalter system set LOG_ARCHIVE_DEST_STATE_2=ENABLE scope=both;\n</code></pre> </p>"},{"location":"Database/Oracle/#creation-dune-standby-par-replication","title":"Cr\u00e9ation d'une STANDBY par r\u00e9plication","text":"<p>Premi\u00e8rement, cr\u00e9er l'arborescence n\u00e9cessaire sur la standby (oradata, oraredolog, oraarch, oractl, admin) puis :  <pre><code>rman\nconnect target sys/change_on_install@black\nconnect auxiliary sys/change_on_install@white\n</code></pre> Et enfin, on lance le clonage : <pre><code>DUPLICATE TARGET DATABASE\n     FOR STANDBY\n     FROM ACTIVE DATABASE\n     DB_FILE_NAME_CONVERT 'BLACK','WHITE'\n     SPFILE\n      PARAMETER_VALUE_CONVERT 'BLACK','WHITE'\n      SET LOG_FILE_NAME_CONVERT 'BLACK','WHITE'\n      SET DB_UNIQUE_NAME 'WHITE';\n</code></pre></p> <p>Ne pas oublier de cr\u00e9er les redologs sur la standby</p> <p> </p>"},{"location":"Database/Oracle/#fsfo","title":"FSFO","text":""},{"location":"Database/Oracle/#verifier-le-status-fsfo","title":"V\u00e9rifier le status FSFO","text":"<p>Avec SQLPLUS <pre><code>set linesize 300\nCOL \"FS_FAILOVER_OBSERVER_HOST\" FORMAT A25\nSELECT fs_failover_status, fs_failover_current_target,\nfs_failover_threshold, fs_failover_observer_present,\nfs_failover_observer_host \nFROM v$database;\n</code></pre> Avec DMGR <pre><code>SHOW FAST_START FAILOVER;\n</code></pre></p> <p> </p>"},{"location":"Database/Oracle/#temps-de-reconnexion-fsfo","title":"Temps de reconnexion FSFO","text":"<p>D\u00e9finit le temps au bout duquel l'observer consid\u00e8re la base primaire KO avant de basculer sur la standby</p> <p>==&gt; DMGR <pre><code>EDIT CONFIGURATION SET PROPERTY FastStartFailoverThreshold = '120';\n</code></pre> ==&gt; SQLPLUS <pre><code>set linesize 200\nCOL \"LAST_FAILOVER_REASON\" FORMAT A25\nSELECT LAST_FAILOVER_TIME, LAST_FAILOVER_REASON FROM V$FS_FAILOVER_STATS;\n</code></pre></p> <p> </p>"},{"location":"Database/Oracle/#datafile","title":"Datafile","text":""},{"location":"Database/Oracle/#resize-datafile","title":"Resize datafile","text":"<pre><code>alter database datafile '/appli/oracle/SF0NAT/oradata01/SF0NAT_sysaux_01.dbf' resize 2048M;\n</code></pre>"},{"location":"Database/Oracle/#ajout-datafile","title":"Ajout datafile","text":"<pre><code>alter tablespace XXXX add datafile '/appli/oracle/SF0NAT/oradata01/SF0NAT_sysaux_01.dbf' size 2048M;\n</code></pre>"},{"location":"Database/Oracle/#redolog","title":"Redolog","text":""},{"location":"Database/Oracle/#supprimer-les-redologs","title":"Supprimer les redologs","text":"<p><pre><code>alter database drop LOGFILE GROUP XX;\n</code></pre> </p>"},{"location":"Database/Oracle/#informations-detaillees-sur-ls-redologs-online-only","title":"Informations d\u00e9taill\u00e9es sur ls redologs (ONLINE only)","text":"<p><pre><code>set linesize 400\nCOL \"MEMBER\" FORMAT A80\nselect l.GROUP#, \n    l.THREAD#, \n    l.SEQUENCE#, \n    l.BYTES, \n    l.MEMBERS, \n    l.STATUS, \n    f.TYPE, \n    f.MEMBER \nfrom V$LOGFILE f, V$LOG l \nwhere l.GROUP# = f.GROUP# \norder by GROUP#,MEMBER;\n</code></pre> </p>"},{"location":"Database/Oracle/#infos-redologs-complet","title":"Infos redologs complet","text":"<p><pre><code>select * from v$logfile;\n</code></pre> </p>"},{"location":"Database/Oracle/#status-redologs","title":"Status redologs","text":"<p><pre><code>set linesize 200\nSELECT GROUP#, BYTES, STATUS, 'ONLINE' AS TYPE FROM V$LOG\nUNION\nSELECT GROUP#, BYTES, STATUS, 'STANDBY' AS TYPE FROM V$STANDBY_LOG\nORDER BY 1;\n</code></pre> </p>"},{"location":"Database/Oracle/#spfile-et-controlfile","title":"Spfile et Controlfile","text":""},{"location":"Database/Oracle/#editer-un-fichier-controlfile-pour-analyse","title":"Editer un fichier controlfile pour analyse","text":"<p><pre><code>ALTER DATABASE BACKUP CONTROLFILE TO TRACE AS '/u01/control.bkp'\n</code></pre> </p>"},{"location":"Database/Oracle/#generer-un-fichier-init-ou-spfile","title":"G\u00e9n\u00e9rer un fichier init ou spfile","text":"<pre><code>create pfile from spfile='/home/oracle/admin/OPHNAT/dbs/spfile.ora'\ncreate spfile from pfile='/home/oracle/admin/OPHNAT/dbs/pfile.ora'\n</code></pre> <p>en cas de perte du param\u00e8tre SPFILE, on peux g\u00e9n\u00e9rer un PFILE depuis la m\u00e9moire <code>create pfile from memory</code></p> <p> </p>"},{"location":"Database/Oracle/#savoir-si-la-base-a-demarre-avec-le-pfile-ou-le-spfile","title":"Savoir si la base a d\u00e9marr\u00e9 avec le pfile ou le spfile","text":"<p><pre><code>SELECT DECODE(value, NULL, 'PFILE', 'SPFILE') \"Init File Type\" \n       FROM sys.v_$parameter WHERE name = 'spfile';\n</code></pre> </p>"},{"location":"Database/Oracle/#inclassable","title":"Inclassable","text":""},{"location":"Database/Oracle/#generer-un-rapport-awr","title":"G\u00e9n\u00e9rer un rapport AWR","text":"<p><pre><code>SQL&gt; @?/rdbms/admin/awrrpt.sql\n\nhtml ou text\n1er param : Nb de rapport \u00e0 afficher pour s\u00e9lection ( en jour ) depuis maintenant\n2eme param : Snapshot d\u00e9but\n3eme param : Snapshot fin\n</code></pre> </p>"},{"location":"Database/Oracle/#supprimer-les-anciens-rapport-awr","title":"Supprimer les anciens rapport AWR","text":"<p><pre><code>connect / as sysdba \n@?/rdbms/admin/catnoawr.sql \n@?/rdbms/admin/catawrtb.sql \n</code></pre> </p>"},{"location":"Database/Oracle/#afficher-et-modifier-les-parametres-systeme","title":"Afficher et modifier les param\u00e8tres syst\u00e8me","text":"<pre><code>SQL&gt; show parameter\nSQL&gt; ALTER SYSTEM SET [Param] = [valeur] | [COMMENT='texte'] [DEFERED] [SCOPE=MEMORY|SPFILE|BOTH];\n</code></pre> <p>DEFERED : Si pr\u00e9sente, indique que la modification ne concerne que les futures sessions (peut \u00eatre obligatoire)     SCOPE : D\u00e9finit la cible de la modification     MEMORY:la m\u00e9moire seulement      SPFILE:le fichier de param\u00e8tres serveur seulement      BOTH:les deux </p> <p> </p>"},{"location":"Database/Oracle/#afficher-le-dernier-reboot-de-la-base","title":"Afficher le dernier reboot de la base","text":"<p><pre><code>set pagesize 300\nset linesize 300\nselect to_char(startup_time, 'HH24:MI DD-MON-YY') \"Startup time\"\nfrom v$instance\n</code></pre> </p>"},{"location":"Database/Oracle/#connaitre-les-parametres-de-langue","title":"Connaitre les param\u00e8tres de langue","text":"<p><pre><code>select * from nls_database_parameters where parameter IN (\u2018NLS_LANGUAGE\u2019,'NLS_TERRITORY\u2019,'NLS_CHARACTERSET\u2019);\n</code></pre> </p>"},{"location":"Database/Oracle/#personnaliser-son-sqlplus","title":"Personnaliser son SQLPLUS","text":"<p><pre><code>SET sqlprompt \"&amp;_USER@&amp;_CONNECT_IDENTIFIER &amp;_PRIVILEGE&gt; \"\n</code></pre> </p>"},{"location":"Database/Oracle/#formater-affichage-sqlplus","title":"Formater affichage SQLPLUS","text":"<p><pre><code>COLUMN &lt;nom_colonne&gt; FORMAT A30;\n</code></pre> </p>"},{"location":"Database/Oracle/#lister-les-objets-invalide","title":"Lister les objets invalide","text":"<p><pre><code>SET ECHO        OFF\nSET HEADING     ON\nSET LINESIZE    1800\nSET PAGESIZE    50000\n\nCOL owner   FORMAT a25  HEADING 'Owner'\nCOL object_name FORMAT a30  HEADING 'Object Name'\nCOL object_type FORMAT a20  HEADING 'Object Type'\nCOL object_id   FORMAT a20  HEADING 'Object ID'\nCOL status  FORMAT a10  HEADING 'Status'\n\nBREAK ON owner SKIP 2 ON report\nCOMPUTE count LABEL \"\" OF object_name ON owner\n\nSELECT\n    owner\n  , object_name\n  , object_type\n  , status\n  , object_id\nFROM dba_objects\nWHERE status &lt;&gt; 'VALID'\nORDER BY owner, object_name\n/\n</code></pre> </p>"},{"location":"Database/Oracle/#status-de-la-registry-oracle-catproccatlog","title":"Status de la registry Oracle (catproc,catlog)","text":"<p><pre><code>set pages 1000\nset lines 120\ncol comp_id format a20\ncol comp_name format a40\ncol version format a10\ncol status format a15\nselect comp_id,comp_name,version,status from dba_registry order by 1;\n</code></pre> </p>"},{"location":"Database/Oracle/#mode-douverture-de-la-base-allowed-ou-restrict","title":"Mode d'ouverture de la base (ALLOWED ou RESTRICT)","text":"<p>Au d\u00e9marrage <pre><code>startup restrict\n</code></pre> Quand la base est OPEN <pre><code>alter system enable restricted session;\n</code></pre> Faire un retour arri\u00e8re <pre><code>alter system disable restricted session;\n</code></pre> V\u00e9rifier le retour \u00e0 la normal <pre><code>SELECT logins from v$instance;\n</code></pre></p> <p> </p>"},{"location":"Database/Oracle/#connaitre-les-options-oracle-actives","title":"Connaitre les options oracle activ\u00e9s","text":"<p>A l'installation <pre><code>set pagesize 100\nset page off\nCol parameter format a50 heading \"Option\"\nCol value format a5  heading \"Value\" justify center wrap\nSelect parameter, value\nfrom v$option \norder by 2 desc\n/\n</code></pre> A l'utilisation <pre><code>Set feedback off\nSet linesize 122\nCol name             format a45     heading \"Feature\"\nCol version          format a10     heading \"Version\"\nCol detected_usages  format 999,990 heading \"Detected|usages\"\nCol currently_used   format a06     heading \"used\"\nCol first_usage_date format a10     heading \"First use\"\nCol last_usage_date  format a10     heading \"Last use\"\n       select name, version, detected_usages, currently_used,\n       to_char(first_usage_date,'DD/MM/YYYY') first_usage_date, \n       to_char(last_usage_date,'DD/MM/YYYY') last_usage_date\nfrom dba_feature_usage_statistics\nwhere name in ('Data Mining','Oracle Database Vault','Label Security') or name like ('OLAP%');\n</code></pre></p> <p> </p>"},{"location":"Database/Oracle/#afficher-les-services-applicatifs-oracle","title":"Afficher les services applicatifs oracle","text":"<p>En tant que DBA <pre><code>COL \"FAILOVER_METHOD\" FORMAT A15\nCOL \"FAILOVER_TYPE\" FORMAT A15\nCOL \"NAME\" FORMAT A15\nCOL \"EDITION\" FORMAT A15\nCOL \"ENABLED\" FORMAT A15\nCOL \"DTP\" FORMAT A5\nselect * from dba_services;\n</code></pre> Sans droits DBA <pre><code>COL \"NETWORK_NAME\" FORMAT A15\nselect * from v$services; \n</code></pre></p> <p> </p>"},{"location":"Database/Oracle/#personnaliser-son-sqlplus_1","title":"Personnaliser son SQLPLUS","text":"<p><pre><code>SET sqlprompt \"&amp;_USER@&amp;_CONNECT_IDENTIFIER &amp;_PRIVILEGE&gt; \"\n</code></pre> </p>"},{"location":"Docker/Containers/","title":"Docker","text":""},{"location":"Docker/Containers/#container-command","title":"Container command","text":""},{"location":"Docker/Containers/#lister-les-containers","title":"Lister les containers","text":"<p><pre><code>docker ps [-a]\n</code></pre> </p>"},{"location":"Docker/Containers/#recuperer-le-container-id-avec-le-nom-de-limage-docker","title":"R\u00e9cup\u00e9rer le container ID avec le nom de l'image docker","text":"<p><pre><code>docker-compose ps -q alerta-web\n</code></pre> </p>"},{"location":"Docker/Containers/#se-connecter-a-un-container","title":"Se connecter \u00e0 un container","text":"<p><pre><code>docker exec -i -t &lt;INSTANCE_ID&gt; bash\n</code></pre> ou <pre><code>docker exec -it $(docker-compose ps -q alerta-web) bash\n</code></pre> </p>"},{"location":"Docker/Containers/#cibler-lemplacement-dun-fichier-de-log-dun-container","title":"Cibler l'emplacement d'un fichier de log d'un container","text":"<p><pre><code>docker inspect --format='{{.LogPath}}' $INSTANCE_ID\n</code></pre> </p>"},{"location":"Docker/Containers/#afficher-les-logs-dun-container","title":"Afficher les logs d'un container","text":"<p><pre><code>docker logs &lt;INSTANCE_ID&gt;\n</code></pre> </p>"},{"location":"Docker/Containers/#supprimer-le-storage-adosse-a-un-container","title":"Supprimer le storage adoss\u00e9 \u00e0 un container","text":"<p><pre><code>rm -Rf /var/lib/docker/volumes/...\n</code></pre> </p>"},{"location":"Git/Tags/","title":"Tags","text":""},{"location":"Git/Tags/#gerer-les-tags-dun-depot-git","title":"G\u00e9rer les Tags d'un d\u00e9p\u00f4t git","text":""},{"location":"Git/Tags/#supprimer-tous-les-tags-remote","title":"Supprimer tous les Tags \"remote\"","text":"<pre><code>git tag | xargs -L 1 | xargs git push origin --delete\n</code></pre>"},{"location":"Git/Tags/#supprimer-tous-les-tags-locaux","title":"Supprimer tous les Tags \"locaux\"","text":"<pre><code>git tag | xargs -L 1 | xargs git tag --delete\n</code></pre>"},{"location":"Linux/Command/","title":"OsCommand","text":""},{"location":"Linux/Command/#infos-cpu","title":"Infos CPU","text":""},{"location":"Linux/Command/#affichage-type-processeur","title":"Affichage type processeur","text":"<p><pre><code>cat /proc/cpuinfo | grep \"model name\"\n</code></pre> </p>"},{"location":"Linux/Command/#nombre-de-coeur-physique","title":"Nombre de coeur physique","text":"<p><pre><code>grep \"physical id\" /proc/cpuinfo |sort -u |wc -l\n</code></pre> </p>"},{"location":"Linux/Command/#nombre-de-coeur-logique","title":"Nombre de coeur logique","text":"<pre><code>grep -c \"processor\" /proc/cpuinfo\n</code></pre>"},{"location":"Linux/Command/#infos-demarrage","title":"Infos d\u00e9marrage","text":""},{"location":"Linux/Command/#dernier-reboot","title":"Dernier reboot","text":"<p><pre><code>last reboot | head -1\n</code></pre> ou <pre><code>who -b\n</code></pre> </p>"},{"location":"Linux/Command/#dernier-shutdown","title":"Dernier shutdown","text":"<pre><code>last -x|grep shutdown | head -1\n</code></pre>"},{"location":"Linux/Command/#compressiondecompression","title":"Compression/D\u00e9compression","text":""},{"location":"Linux/Command/#decompresser-avec-rebase","title":"D\u00e9compresser avec rebase","text":"<pre><code>tar xvf &lt;file&gt; --strip-components 5\n</code></pre>"},{"location":"Linux/Command/#tarball-one-liner","title":"Tarball one-liner","text":"<pre><code>tar xzf - -C ${HOME}/Tools k9s.exe &lt; &lt;(curl -Ls --cacert ${CERTS_FULL_CA_BUNDLE} ${K9S_URL})\n</code></pre>"},{"location":"Linux/Command/#tester-une-connection-tcp","title":"Tester une connection TCP","text":"<pre><code>SERVER=google.com PORT=80 \nif (: &lt;/dev/tcp/$SERVER/$PORT) 2&gt;/dev/null\nthen\nprintf \"succeeded \\n\"\nelse\nprintf \"failed \\n\"\nfi\n</code></pre> <p>Info</p> <p>variante one-liner</p> <p><pre><code>bash -c 'exec 3&lt;&gt; /dev/tcp/'localhost'/'22';echo $?' 2&gt;/dev/null\n</code></pre> </p>"},{"location":"Linux/Command/#tunnel-ssh","title":"Tunnel SSH","text":"<p>Exemple d'un tunnel http pour mise a jour yum</p> <p>Machine 1 : Source Machine 2 : cible (acc\u00e8s internet)</p> <p>Machine 1 Dans /etc/yum.conf <pre><code>proxy=socks5h://localhost:1080\n</code></pre> puis taper la commande suivante <pre><code>ssh -D 1080 root@machine 2\n</code></pre></p> <p>puis taper la commande d\u00e9sir\u00e9 sur la machine 1 depuis un autre terminal (tr\u00e8s important)</p> <p> </p>"},{"location":"Linux/Command/#yum","title":"YUM","text":""},{"location":"Linux/Command/#option-downloadonly","title":"Option \"downloadonly\"","text":"<pre><code>yum install --downloadonly --downloaddir=&lt;path&gt; &lt;package&gt;\n</code></pre> <p>Info</p> <p>Pr\u00e9requis : Installer le package yum-downloadonly</p> <p> </p>"},{"location":"Linux/Command/#file-system-visualisation","title":"File System (visualisation)","text":""},{"location":"Linux/Command/#creation-fichier-avec-masque-defini","title":"Cr\u00e9ation fichier avec masque d\u00e9fini","text":"<pre><code>umask 022\n</code></pre> <p>Info</p> <p>(avec 022 = chmod 755)</p>"},{"location":"Linux/Command/#affichage-espace-libre-ou-occupe","title":"Affichage espace libre ou occup\u00e9","text":""},{"location":"Linux/Command/#affichage-espace-occupe-en-mo","title":"Affichage espace occup\u00e9 en Mo","text":"<pre><code>du -sm\n</code></pre>"},{"location":"Linux/Command/#top-10-des-plus-gros-fichiers","title":"Top 10 des plus gros fichiers","text":"<pre><code>du -am . | sort -nr | head -10\n</code></pre>"},{"location":"Linux/Command/#tri-sur-la-4eme-colonne","title":"Tri sur la 4eme colonne","text":"<pre><code>df -h | sort -nk4\n</code></pre>"},{"location":"Linux/Crontab/","title":"Crontab","text":""},{"location":"Linux/Crontab/#lire-une-crontab","title":"Lire une crontab","text":"<p>Dans l'ordre des \u00e9toiles (de gauche \u00e0 droite)</p> <ul> <li>minutes (0 \u00e0 59)</li> <li>heures (0 \u00e0 23)</li> <li>jours du mois (1 \u00e0 31)</li> <li>mois (1\u00e012)</li> <li>jours de la semaine (0 \u00e0 6) 0 = dimanche</li> </ul> <p>Avec pour chaque unit\u00e9s de temps, le notations possible</p> <ul> <li> <ul> <li>: a chaque unit\u00e9 de temps</li> </ul> </li> <li>2-5 : les unit\u00e9s de temps (2,3,4,5)</li> <li>*/3 : toutes les 3 unit\u00e9s de temps (0,3,6,\u2026)</li> <li>5,8 : les unit\u00e9s de temps 5 et 8</li> </ul> <p>Exemple :</p> <p>$ Toutes les 5 minutes <pre><code>*/5 * * * * /usr/bin/php /home/user1/scripts/test.php &gt;&gt; /dev/null\n</code></pre> $ Tous les jours \u00e0 10h42 <pre><code>42 10 * * * /usr/bin/php /home/user1/scripts/test.php &gt;&gt; /dev/null\n</code></pre> $ Tous les premiers mars \u00e0 12h15 <pre><code>15 12 1 3 * /usr/bin/php /home/user1/scripts/test.php &gt;&gt; /dev/null\n</code></pre> $ Tous les lundis \u00e0 19h00 <pre><code>0 19 * * 1 /usr/bin/php /home/user1/scripts/test.php &gt;&gt; /dev/null\n</code></pre></p>"},{"location":"Linux/Firewall/","title":"Firewall","text":""},{"location":"Linux/Firewall/#etat-firewall","title":"Etat Firewall","text":"<p><pre><code>firewall-cmd --state\n</code></pre> </p>"},{"location":"Linux/Firewall/#liste-des-services-actifs","title":"Liste des services actifs","text":"<pre><code>firewall-cmd --list-services\n</code></pre>"},{"location":"Linux/Firewall/#ajouter-un-service-zone-public","title":"Ajouter un service (zone public)","text":"<p><pre><code>firewall-cmd --zone=public --permanent --add-service=http\n</code></pre> puis <pre><code>systemctl restart firewalld.service\n</code></pre></p>"},{"location":"Linux/Init/","title":"Init","text":""},{"location":"Linux/Init/#afficher-les-services-systemd","title":"Afficher les services systemd","text":"<p><pre><code>systemctl list-dependencies\n</code></pre> </p>"},{"location":"Linux/Init/#creer-un-service-redhatcentos","title":"Cr\u00e9er un service (RedHat/Centos)","text":"<p><pre><code>vim /etc/systemd/system/gammu.service\n</code></pre> <pre><code>    # Systemd unit file for Gammu\n    [Unit]\n    Description=Gammu SMS\n    After=network.target\n\n    [Service]\n    Type=forking\n\n    ExecStart=/etc/init.d/gammu-smsd-init start\n    ExecStop=/etc/init.d/gammu-smsd-init stop\n\n    User=gammu\n    Group=gammu\n\n    [Install]\n    WantedBy=multi-user.target\n</code></pre></p> <p>Activation du service  <pre><code>systemctl start gammu.service\n</code></pre> <pre><code>systemctl enable gammu.service\n</code></pre> </p>"},{"location":"Linux/LVM/","title":"LVM","text":""},{"location":"Linux/LVM/#creer-une-partition-pv-associes","title":"Cr\u00e9er une partition + PV associ\u00e9s","text":"<pre><code>parted /dev/sdX\n\n(parted) print\nMod\u00e8le: ATA SAMSUNG SSD PM85 (scsi)\nDisque /dev/sda : 128GB\nTaille des secteurs (logiques/physiques): 512B/512B\nTable de partitions : msdos\nDisk Flags:\n\nNum\u00e9ro  D\u00e9but   Fin     Taille  Type     Syst\u00e8me de fichiers  Fanions\n 1      1049kB  1075MB  1074MB  primary  xfs                  d\u00e9marrage\n 2      1075MB  41,2GB  40,1GB  primary                       lvm (gestionnaire de volumes logiques)\n 3      41,2GB  51,2GB  9987MB  primary                       lvm (gestionnaire de volumes logiques)\n\n(parted) mkpart\nType de partition ?  primary/primaire/extended/\u00e9tendue? primary\nType de syst\u00e8me de fichiers ?  [ext2]? ext3\nD\u00e9but ? 51,2GB\nFin ? 128GB\n\nNum\u00e9ro  D\u00e9but   Fin     Taille  Type     Syst\u00e8me de fichiers  Fanions\n 1      1049kB  1075MB  1074MB  primary  xfs                  d\u00e9marrage\n 2      1075MB  41,2GB  40,1GB  primary                       lvm (gestionnaire de volumes logiques)\n 3      41,2GB  51,2GB  9987MB  primary                       lvm (gestionnaire de volumes logiques)\n 4      51,2GB  128GB   76,8GB  primary\n\n\n(parted) set 4 lvm on\n(parted) print\n\nNum\u00e9ro  D\u00e9but   Fin     Taille  Type     Syst\u00e8me de fichiers  Fanions\n 1      1049kB  1075MB  1074MB  primary  xfs                  d\u00e9marrage\n 2      1075MB  41,2GB  40,1GB  primary                       lvm (gestionnaire de volumes logiques)\n 3      41,2GB  51,2GB  9987MB  primary                       lvm (gestionnaire de volumes logiques)\n 4      51,2GB  128GB   76,8GB  primary                       lvm (gestionnaire de volumes logiques)\n</code></pre>"},{"location":"Linux/LVM/#creer-un-volume-logique","title":"Cr\u00e9er un volume logique","text":"<pre><code>lvcreate -L 1G -n &lt;Label Volume&gt; &lt;VG&gt;\nlvdisplay &lt;Volume_du_FS&gt;\nmkfs.ext4 &lt;Volume_du_FS&gt;\nmkdir &lt;FS&gt;\n&lt;Modifier /ets/fstab&gt;\n== /dev/root_vg/lv_usr_tivoli_tsm /usr/tivoli/tsm ext4 defaults 1 3 ==\nmount -a &lt;FS&gt;\ndf -h &lt;FS&gt; ==&gt; pour v\u00e9rifier\n</code></pre> <p>Note</p> <p>Si la commande <code>umount</code> ne marche pas, faire un <code>lsof</code>du FS pour voir si un process tente d'y acc\u00e9der, sinon utiliser commande <code>umount -l</code></p> <p> </p>"},{"location":"Linux/LVM/#manipuler-un-volume-logique","title":"Manipuler un volume logique","text":"<p><pre><code>df -h &lt;FS&gt;\nlvextend -L 12G &lt;Volume_du_FS&gt;\numount &lt;FS&gt;\ne2fsck -f &lt;Volume_du_FS&gt;\nresize2fs &lt;Volume_du_FS&gt;\nmount &lt;FS&gt;\ndf -h &lt;FS&gt; ==&gt; Pour v\u00e9rifier\n</code></pre> variante XFS</p> <p>Note</p> <p>Remplacer      <code>resize2fs</code>  Par     <code>xfs_growfs</code>"},{"location":"Linux/User-Group/","title":"User/Group","text":""},{"location":"Linux/User-Group/#gestion-usergroup","title":"Gestion User/Group","text":""},{"location":"Linux/User-Group/#creer-un-utilisateur","title":"Cr\u00e9er un utilisateur","text":"<p><pre><code>useradd -g &lt;gid&gt; &lt;user&gt;\n</code></pre> </p>"},{"location":"Linux/User-Group/#creer-un-groupe","title":"Cr\u00e9er un groupe","text":"<p><pre><code>groupadd -g &lt;gid&gt; &lt;user&gt;\n</code></pre> </p>"},{"location":"Linux/User-Group/#modifier-luid-dun-user","title":"Modifier l'UID d'un user","text":"<p><pre><code>usermod -u &lt;uid&gt; &lt;user&gt;\n</code></pre> </p>"},{"location":"Linux/User-Group/#ajout-dun-groupe-primaire-a-un-utilisateur","title":"Ajout d'un groupe primaire \u00e0 un utilisateur","text":"<p><pre><code>usermod -g &lt;group&gt; &lt;user&gt;\n</code></pre> </p>"},{"location":"Linux/User-Group/#ajout-de-multiple-utilisateur-a-un-groupe-existant","title":"Ajout de multiple utilisateur \u00e0 un groupe existant","text":"<p><pre><code>usermod -a -G &lt;group1&gt;,&lt;group2&gt;,&lt;group3&gt; &lt;user&gt;\n</code></pre> </p> <p>option pour usermod</p> <p>Info</p> <p>-d r\u00e9pertoire utilisateur -g d\u00e9finit le GID principal -l identifiant utilisateur -u UID utilisateur -s shell par d\u00e9faut -G ajoute l\u2019utilisateur \u00e0 des groupes secondaires -m d\u00e9place le contenu du r\u00e9pertoire personnel vers le nouvel emplacement</p>"},{"location":"Linux/Vim/","title":"Vim","text":""},{"location":"Linux/Vim/#modification-vim","title":"Modification VIM","text":""},{"location":"Linux/Vim/#gestion-des-erreur-de-pipe","title":"Gestion des erreur de pipe","text":"<pre><code>set -o pipefail\n</code></pre>"},{"location":"Linux/Vim/#exit-immediat-du-script-sur-erreur","title":"Exit imm\u00e9diat du script sur erreur","text":"<pre><code>set -e\n</code></pre> <p>A combiner avec le \"pipefail\" :)</p>"},{"location":"Linux/Vim/#mode-debug","title":"Mode \"debug\"","text":"<pre><code>set -vx\n</code></pre>"},{"location":"Linux/Vim/#changer-lediteur-par-defaut-du-shell","title":"Changer l'\u00e9diteur par d\u00e9faut du shell","text":"<pre><code>set -o vi\n</code></pre>"},{"location":"Linux/Vim/#pour-en-savoir-plus-sur-set","title":"Pour en savoir plus sur \"set\"","text":"<p>Option sur set</p> <p> </p>"},{"location":"Linux/Vim/#_1","title":"Vim","text":""},{"location":"Linux/Vim/#colorisation-vim","title":"Colorisation VIM","text":""},{"location":"Linux/Vim/#modifier-les-couleurs-dans-un-shell-redhat","title":"Modifier les couleurs dans un shell (RedHat)","text":"<p>Editer le fichier /etc/DIR_COLORS et remplacer  <code>DIR 00;34       # directory</code> par <code>DIR 00;32       # directory</code></p> <p>Info</p> <p>Les r\u00e9pertoires vont apparaitre en vert au lieu de bleu</p> <p> </p>"},{"location":"Microsoft/Windows/","title":"Win_stuff","text":"<p>## Dernier reboot </p> <pre><code>Net Statistics Server\n</code></pre> <p>## Lister un processus (Powershell version)</p> <pre><code>netstat -ano | Out-String -Stream | Select-String -Pattern &lt;PATTERN&gt;\n</code></pre> <p>## Lister un processus par num\u00e9ro de port</p> <pre><code>netstat -an | find /n &lt;N\u00b0 Port&gt;\n</code></pre>"},{"location":"Microsoft/Windows/#creer-une-boucle-for-pour-renommer-une-liste-de-fichiers-debut-du-fichier","title":"Cr\u00e9er une boucle for pour renommer une liste de fichiers (Debut du fichier)","text":"<pre><code>@echo off\nsetlocal enabledelayedexpansion\n\nfor /f \"delims==\"&lt;nowiki&gt; f in ('dir /b ^| findstr mp3') do ( set old=&lt;/nowiki&gt;f &amp; call :trait)\n\ngoto next\n\n:trait\nset new=%old:~3%\nRen \"!old!\" \"!new!\"\n\n:next\n</code></pre> <p>Info</p> <p>Le FINDSTR permet de cibler un type particulier de fichier Remplacer le nombre dans la variable NEW pour tronquer un nombre de caractere precis (espace inclus)  </p>"},{"location":"Microsoft/Windows/#equivalent-sed","title":"Equivalent SED","text":"<ul> <li> <p>Trouver la ligne et la stocker en variable <pre><code>for /f \"delims=\" %%i in ('type %PATH%\\%FILE% ^|find \"LA_LIGNE\"') do @set LIGNE=%%i\n</code></pre></p> </li> <li> <p>Modifier un champ dans la ligne (ACTIVE en SUSPEND) <pre><code>set LIGNE=%LIGNE:ACTIVE=SUSPEND%\n</code></pre></p> </li> <li> <p>Copier vers un fichier TMP , exclure la ligne \u00e0 modifier, supprimer le fichier TMP <pre><code>Copy %PATH%\\%FILE% %PATH%\\%TMPFIC%\nFind /V \"LA_LIGNE\" &lt;%PATH%\\%TMPFIC%&gt; %PATH%\\%JOBFILE%\nDel %PATH%\\%TMPFIC%\n</code></pre></p> </li> <li> <p>Inclure la ligne modifi\u00e9 dans le fichier <pre><code>echo %LIGNE%&gt;&gt; %PATH%\\%FILE%\n</code></pre></p> </li> </ul>"},{"location":"Microsoft/Windows/#test-fichier-vide","title":"Test fichier vide","text":"<pre><code>for /f %%i in ('echo %PATH%\\Fichier.txt') do if %%~zi GTR 0 goto error\n</code></pre>"},{"location":"Microsoft/Windows/#extension-de-parametres-substitution","title":"Extension de param\u00e8tres (substitution)","text":"<p>La substitution de param\u00e8tres de commandes (%n) a \u00e9t\u00e9 am\u00e9lior\u00e9e. Vous</p> <p>pouvez maintenant utiliser la syntaxe suivante en option :</p> <pre><code>  %~1         - \u00e9tend %1 en supprimant les guillemets (\")\n\n  %~f1        - \u00e9tend %1 en nom de chemin d'acc\u00e8s reconnu\n\n  %~d1        - \u00e9tend %1 en lettre de lecteur uniquement\n\n  %~p1        - \u00e9tend %1 en chemin d'acc\u00e8s uniquement\n\n  %~n1        - \u00e9tend %1 en nom de fichier uniquement\n\n  %~x1        - \u00e9tend %1 en extension de fichier uniquement\n\n  %~s1        - chemin \u00e9tendu contenant uniquement des noms courts\n\n  %~a1        - \u00e9tend %1 en attributs du fichier\n\n  %~t1        - \u00e9tend %1 en date/heure du fichier\n\n  %~z1        - \u00e9tend %1 en taille du fichier\n\n  %~$PATH:1   - parcourt les r\u00e9pertoires de la variable\n\n                 d'environnement PATH et \u00e9tend %1 en nom du\n\n                 premier fichier reconnu trouv\u00e9. Si le nom de la\n\n                 variable d'environnement n'est pas d\u00e9fini ou\n\n                 que le fichier n'est pas trouv\u00e9 par la recherche,\n\n                 alors ce modificateur \u00e9tend en cha\u00eene vide\n</code></pre> <p>Vous pouvez combiner les modificateurs pour des r\u00e9sultats compos\u00e9s :</p> <pre><code>   %~dp1       - \u00e9tend %1 en lettre de lecteur et chemin d'acc\u00e8s\n\n                  uniquement\n\n   %~nx1       - \u00e9tend %1 en nom de fichier et extension uniquement\n\n   %~dp$PATH:1 - parcourt les r\u00e9pertoires list\u00e9s dans la variable\n\n                  d'environnement PATH \u00e0 la recherche de %1 et \u00e9tend\n\n                  en lettre de lecteur du premier trouv\u00e9.\n\n   %~ftza1     - \u00e9tend %1 en DIR comme ligne en sortie\n</code></pre> <p>Abstract</p> <p>Dans les exemples ci-dessus %1 et PATH peuvent \u00eatre remplac\u00e9s par d'autres valeurs valides. La syntaxe %~ se termine par un num\u00e9ro d'argument valide. Vous ne pouvez pas utiliser les modificateurs %~ avec %*</p>"},{"location":"Microsoft/Windows/#substring","title":"Substring","text":"<p>Dans le cas pr\u00e9sent, mydate = 20140630 et my_year = 2014 <pre><code>set my_date=%1\nset my_year=%my_date:~0,4%\n</code></pre></p>"},{"location":"Middleware/Apache/","title":"Apache","text":""},{"location":"Middleware/Apache/#installer-apache-one-liner","title":"Installer apache (one-liner)","text":"<p><pre><code>$APACHE_HOME/bin/scripts; ./build-instance -i &lt;site&gt; -p 80 -s 443 --adresse $(hostname -i) --fqdn &lt;fqdn&gt; --console --boot\n</code></pre> </p>"},{"location":"Middleware/Apache/#afficher-les-modules-dans-apache","title":"Afficher les modules dans apache","text":"<p><pre><code>$APACHE_HOME/bin/apachectl -t -D DUMP_MODULES\n</code></pre> ou</p> <pre><code>$APACHE_HOME/bin/apachectl -M\n</code></pre>"},{"location":"Middleware/Postfix/","title":"Postfix","text":""},{"location":"Middleware/Postfix/#afficher-la-mailqueue","title":"Afficher la mailqueue","text":"<p><pre><code>mailq\n</code></pre> ou <pre><code>postqueue -p\n</code></pre> </p>"},{"location":"Middleware/Postfix/#purger-la-mailqueue","title":"Purger la mailqueue","text":"<p><pre><code>postsuper -d ALL &lt;incoming|active|deferred&gt;\n</code></pre> </p>"},{"location":"Middleware/Postfix/#forcer-les-envoie-de-mails","title":"Forcer les envoie de mails","text":"<p><pre><code>postqueue -f\n</code></pre> </p>"},{"location":"Middleware/Weblogic/","title":"Weblogic","text":""},{"location":"Middleware/Weblogic/#recuperation-du-mot-de-passe-de-la-console-admin","title":"R\u00e9cup\u00e9ration du mot de passe de la console Admin","text":"<p>Lire le contenu du fichier suivant et r\u00e9cup\u00e9rer le mot de passe crypt\u00e9 : </p> <p><pre><code>cat /appli/projects/&lt;appli&gt;/weblogic/wl-domains/DOMAINE-WLS-&lt;appli&gt;/boot.properties\n\n#Wed Mar 13 10:14:49 MET 2013\npassword={3DES}kJ+OsoE3XM3AIqeZ9xpi9w\\=\\=\nusername={3DES}undiEtVW0cdtSOY+0sNAWQ\\=\\=\n</code></pre> Se positionner dans le r\u00e9pertoire suivant : <pre><code>cd /appli/projects/&lt;appli&gt;/weblogic/wl-domains/DOMAINE-WLS-&lt;appli&gt;/security\n</code></pre></p> <p>3 - Cr\u00e9er un fichier python avec l'extension \".py\" contenant ceci (et le rendre ex\u00e9cutable) : </p> <pre><code>from weblogic.security.internal import *\nfrom weblogic.security.internal.encryption import *\n\n# Remind user about how to use\nraw_input(\"Please ensure SerializedSystemIni.dat is in the current directory now, and press ENTER to continue.\")\n\n# Get encryption service\nencryptionService = SerializedSystemIni.getEncryptionService(\".\")\nclearOrEncryptService = ClearOrEncryptedService(encryptionService)\n\n# Get user to enter password\npwd = raw_input(\"Enter encrypted password (Eg. {3DES}Y1fA34S...): \")\n\n# Remove unnecessary escape characters\npreppwd = pwd.replace(\"\\\\\", \"\")\n\n# Decrypt the password\nprint \"Recovered password is: \" + clearOrEncryptService.decrypt(preppwd)\n</code></pre> <p>Abstract</p> <p>Vous devez apercevoir le fichier suivant dans le r\u00e9pertoire : ''SerializedSystemIni.dat''</p> <p>Ex\u00e9cuter la commande suivante : </p> <pre><code>${WL_HOME}/common/bin/wlst.sh fichier.py\n</code></pre> <p>Entrer le mot de passe crypt\u00e9 r\u00e9cup\u00e9r\u00e9 initialement lorsqu'il vous est demand\u00e9.</p> <p>Success</p> <p>FIN</p>"},{"location":"Middleware/Weblogic/#verifier-lexistence-des-process-weblogic","title":"V\u00e9rifier l'existence des process weblogic","text":"<pre><code>ps -C java --no-headers --sort=pid -o pid,args | sed -ne 's/^[[:blank:]]*\\([[:digit:]]\\+\\).*-Dweblogic.Name=\\([^[:blank:]]\\+\\).*$/\\1\\t\\2/p'\n</code></pre>"},{"location":"Middleware/Websphere/","title":"Websphere","text":""},{"location":"Middleware/Websphere/#installer-un-sdk7-sur-was-855","title":"Installer un SDK7 sur WAS 8.5.5","text":"<ul> <li>Stopper les serveurs applicatifs</li> <li> <p>Lister les version de SDK disponible <pre><code>./imcl listAvailablePackages -repositories /mntnfs/EXPORT_PRODUIT/Websphere/WAS-8.5.5/AIX/SDK7/repository.config\n</code></pre></p> </li> <li> <p>Installation du SDK + prise en compte du nouveau SDK <pre><code>/tech/IBMIM/eclipse/tools/imcl install com.ibm.websphere.IBMJAVA.v71_7.1.3030.20160224_1952 -repositories /mntnfs/EXPORT_PRODUIT/Websphere/WAS-8.5.5/AIX/SDK7/ -installationDirectory /tech/WebSphere/8.5.0/noyau/cr3_64 -showProgress\n\n./bin/managesdk.sh -setNewProfileDefault -sdkname 1.7.1_64\n./bin/managesdk.sh -listAvailable\n./bin/managesdk.sh -listEnabledProfileAll\n./bin/managesdk.sh -enableProfile -profileName DmgrVCR3_01 -sdkname 1.7.1_64      //  + relance DMGR\n./bin/managesdk.sh -listEnabledProfileAll\n./bin/managesdk.sh -enableProfile -profileName ProfVCR3_01_01 -sdkname 1.7.1_64   //  + relance Node\n</code></pre></p> </li> <li> <p>D\u00e9sinstaller un package avec IMCL <pre><code>./imcl listInstalledPackages\n./imcl listInstallationDirectories\n\n./imcl uninstall com.ibm.websphere.IHS.v85_8.5.5000.20130514_1044 -installationDirectory /was/IBM/HTTPServer\nUninstalled com.ibm.websphere.IHS.v85_8.5.5000.20130514_1044 from the /was/IBM/HTTPServer directory.\n</code></pre></p> </li> </ul>"},{"location":"Middleware/Websphere/#manage-profile","title":"Manage Profile","text":"<pre><code>$app_server_root/bin/manageprofiles.sh\n\n-listProfiles\n-delete -profileName &lt;ProfName&gt;\n-validateAndUpdateRegistry  (after a delete for example)\n</code></pre>"},{"location":"Middleware/Websphere/#commande-jython","title":"Commande Jython","text":"<ul> <li> <p>Se connecter en jython <pre><code>wsadmin.sh -lang jython -f &lt;file&gt;\n</code></pre></p> </li> <li> <p>List Application Server <pre><code>AdminTask.listServers('[-serverType APPLICATION_SERVER ]')\n</code></pre></p> </li> <li> <p>Remove Server <pre><code>AdminTask.deleteServer( '[ -nodeName NodeGWF01 -serverName AsJGWF_WKF02 ]' )\n</code></pre></p> </li> <li> <p>Add Server <pre><code>AdminConfig.create('Server', mynode, ['name', 'AsJGWF_WKF02'])\nAdminTask.createApplicationServer ( mynode , ['-name', 'test1', '-templateName', 'default']) \n\nJACL version\n$AdminTask createApplicationServer mynode {-name &lt;servername&gt; -templateName default}\n</code></pre></p> </li> <li> <p>Save config <pre><code>AdminConfig.save()\n</code></pre></p> </li> </ul>"},{"location":"Security/OpenSSL/","title":"OpenSSL","text":"<p>Lien utile: https://geekflare.com/fr/openssl-commands-certificates/ </p>"},{"location":"Security/OpenSSL/#liste-des-fichiers-pris-pour-exemple","title":"Liste des fichiers pris pour exemple","text":"<p><pre><code>-rw-r--r-- 1 500000339 1049089 1706 mars  12 15:43 myprivatekey.rsa\n-rw-r--r-- 1 500000339 1049089  230 mars  12 15:44 csr.ini\n-rw-r--r-- 1 500000339 1049089  460 mars  12 15:47 myprivatekey.rsa.pub\n-rw-r--r-- 1 500000339 1049089 1274 mars  12 16:50 cert_out.pem\n-rw-r--r-- 1 500000339 1049089    0 mars  12 17:29 csr.pem\n</code></pre> </p>"},{"location":"Security/OpenSSL/#contenu-de-la-configuration-csr","title":"Contenu de la configuration CSR","text":"<p><pre><code>[req]\ndefault_bits = 2048\ndistinguished_name = dn\nprompt             = no\nencrypt_key        = no\nreq_extensions = req_ext\n\n[dn]\nC=\"FR\"\nL=\"Nantes\"\nO=\"MyEnterprise\"\nOU=\"IT\"\nCN=\"*.domain.com\"\nemailAddress=\"me@domain.com\"\"\n\n[ req_ext ]\nsubjectAltName = DNS: www.exemple.com, DNS: mail.exemple.com, IP: 192.168.1.1\n</code></pre> </p>"},{"location":"Security/OpenSSL/#generer-une-cle-prive","title":"G\u00e9n\u00e9rer une cl\u00e9 priv\u00e9","text":"<p><pre><code>openssl.exe genrsa -out myprivatekey.rsa\n</code></pre> </p>"},{"location":"Security/OpenSSL/#generer-une-cle-publique-depuis-une-cle-prive","title":"G\u00e9n\u00e9rer une cl\u00e9 publique depuis une cl\u00e9 priv\u00e9","text":"<p><pre><code>openssl.exe rsa -in myprivatekey.rsa -pubout -out myprivatekey.rsa.pub\n</code></pre> </p>"},{"location":"Security/OpenSSL/#demande-de-certificat-generer-son-csr","title":"Demande de certificat - G\u00e9n\u00e9rer son CSR","text":"<p><pre><code>openssl req \u2013key myprivatekey.rsa \u2013new -config csr.ini \u2013out csr.pem\n</code></pre> </p>"},{"location":"Security/OpenSSL/#generer-un-certificat-dautorite-ac-auto-signe","title":"G\u00e9n\u00e9rer un certificat d'autorit\u00e9 (AC) auto-sign\u00e9","text":"<p><pre><code>openssl x509 -req -signkey myprivatekey.rsa -in csr.pem -days 1000 -out cert_out.pem\n</code></pre> </p>"},{"location":"Security/OpenSSL/#simuler-un-echange-clientserveur-pour-debug-ssl","title":"Simuler un \u00e9change client/serveur pour debug SSL","text":"<p><pre><code>Server :\nopenssl.exe s_server -accept 127.0.0.1:4433 -cert cert_out.pem -key myprivatekey.rsa\n\nClient :\nopenssl.exe s_client -host 127.0.0.1 -port 4433\n</code></pre> </p>"},{"location":"Terraform/Terraform/","title":"Terraform","text":""},{"location":"Terraform/Terraform/#conditions","title":"Conditions","text":""},{"location":"Terraform/Terraform/#mode-boolean","title":"Mode \"boolean\"","text":"<pre><code>resource \"aws_lb\" \"network-lb\" {\ncount = var.lb_type == \"network-lb\" ? 1 : 0\nname = \"bitslovers-nlb\"\n[...]\n}\n</code></pre> <p>Info</p> <p>Lire : Si la variable \"lb_type\" est valoris\u00e9e \u00e0 \"network-lb\", alors le module ou la ressource est d\u00e9ploy\u00e9 Lien : https://www.bitslovers.com/terraform-count/ </p>"},{"location":"Terraform/Terraform/#mode-string","title":"Mode \"string\"","text":"<pre><code>bucket_name = var.test == true ? \"dev\" : \"prod\"\n</code></pre> <p>Info</p> <p>Lire : Si la variable de test contient la valeur \"true\", alors bucket_name = dev , sinon prod Lien : https://spacelift.io/blog/terraform-functions-expressions-loops </p>"},{"location":"Terraform/Terraform/#utiliser-une-liste-ditems-dans-un-fichier-texte","title":"Utiliser une liste d'items dans un fichier texte","text":"<p>Avec une liste d'item de type :</p> <pre><code>item1\nitem2\nitem3\n[...]\n</code></pre> <p>Exemple lors la cr\u00e9ation d'objects \u00e0 l'int\u00e9rieur d'un bucket S3 de mani\u00e8re it\u00e9rative (boucle \"for_each\")</p> <pre><code>resource \"aws_s3_bucket_object\" \"chroot_folder_keep_file_input\" {\n  for_each = toset(compact((split(\"\\n\", file(\"../../environments/${var.aws_env}/${var.env}/${var.domaine}/data/exstream_domains.conf\") ))))\n  bucket   = \"mmb-${var.domaine}-edit-exstream-${var.env}\"\n  key      = \"/${each.key}/in/.keep\"\n}\n</code></pre> <p>Info</p> <p>l'usage de la fonction <code>split</code> terraform permet le d\u00e9coupage selon un pattern, ici le retour chariot la fonction <code>compact</code> permet de g\u00e9rer les lignes vide et de les supprimer de la liste si besoin  </p>"},{"location":"Unix/Aix/","title":"AIX","text":""},{"location":"Unix/Aix/#gestion-usergroup","title":"Gestion User/Group","text":""},{"location":"Unix/Aix/#creer-un-utilisateur","title":"Cr\u00e9er un utilisateur","text":"<p><code>mkuser id=uid pgrp=&lt;groupe_principal&gt; home=/home/nom_utilisateur -m &lt;comment&gt; shell=/usr/bin/ksh nom_utilisateur</code> </p>"},{"location":"Unix/Aix/#creer-un-groupe","title":"Cr\u00e9er un groupe","text":"<p><code>mkgroup id=gid nom_group</code> </p>"},{"location":"Unix/Aix/#installation-package-smitty","title":"Installation package (smitty)","text":""},{"location":"Unix/Aix/#installation","title":"Installation","text":"<p><code>installp -aF -d /blabla all</code> </p>"},{"location":"Unix/Aix/#desinstallation","title":"D\u00e9sinstallation","text":"<p><code>installp -ug tivoli.tsm.client*</code> </p>"},{"location":"Unix/Aix/#lister-les-package","title":"Lister les package","text":"<p><code>lslpp -L</code></p> <p>Info</p> <p>Par date: lslpp -qch | awk -F: '{printf \"%-12s %-40s %-12s %-10s %-10s\\n\",\\(7,\\)2,\\(3,\\)5,$6}' | sort | uniq | sed 's/70/-70/' | sort -t '/' -k 3,3n -k 1,1n -k 2,2n | sed 's/-70/70/'</p>"},{"location":"Unix/Aix/#gestion-des-filesystem","title":"Gestion des FileSystem","text":""},{"location":"Unix/Aix/#agrandir-ou-diminuer-un-fs","title":"Agrandir ou diminuer un FS","text":"<p><code>chfs -a size=[+|-]1G /some/FS</code></p>"},{"location":"Unix/Aix/#lister-les-vg-et-fs-associes","title":"lister les VG et FS associ\u00e9s","text":"<p><code>lsvg applivg</code> <pre><code>VOLUME GROUP:       applivg                  VG IDENTIFIER:  00cef4a700004c0000000163d5ddb30f\nVG STATE:           active                   PP SIZE:        128 megabyte(s)\nVG PERMISSION:      read/write               TOTAL PPs:      399 (51072 megabytes)\nMAX LVs:            512                      FREE PPs:       7 (896 megabytes)\nLVs:                4                        USED PPs:       392 (50176 megabytes)\nOPEN LVs:           4                        QUORUM:         2 (Enabled)\nTOTAL PVs:          1                        VG DESCRIPTORS: 2\nSTALE PVs:          0                        STALE PPs:      0\nACTIVE PVs:         1                        AUTO ON:        yes\nMAX PPs per VG:     130048\nMAX PPs per PV:     1016                     MAX PVs:        128\nLTG size (Dynamic): 1024 kilobyte(s)         AUTO SYNC:      no\nHOT SPARE:          no                       BB POLICY:      relocatable\nPV RESTRICTION:     none                     INFINITE RETRY: no\nDISK BLOCK SIZE:    512                      CRITICAL VG:    no\nFS SYNC OPTION:     no                       CRITICAL PVs:   no\n</code></pre></p> <p><code>lsvg -l applivg</code> <pre><code>applivg:\nLV NAME             TYPE       LPs     PPs     PVs  LV STATE      MOUNT POINT\nlv_cmod             jfs2       80      80      1    open/syncd    /appli/CMOD\nlv_cmodcache        jfs2       160     160     1    open/syncd    /appli/CMOD-cache\nlv_aen              jfs2       80      80      1    open/syncd    /appli/AEN\nlv_logs             jfs2       72      72      1    open/syncd    /logs\n</code></pre> </p>"},{"location":"Unix/Aix/#creer-un-fs-avec-son-lv","title":"Cr\u00e9er un FS (avec son LV)","text":"<p><code>crfs -v jfs2 -m /mountpoint -A yes -g datavg -a size=128M -p rw -a logname=INLINE</code> </p>"},{"location":"Unix/Aix/#supprimer-un-fs-et-le-lv-associe","title":"Supprimer un FS (et le LV associ\u00e9)","text":"<p><code>rmfs -r &lt;FS&gt;</code> </p>"},{"location":"Unix/Aix/#supprimer-un-lv","title":"Supprimer un LV","text":"<p><code>rmlv -f &lt;LV&gt;</code> </p>"},{"location":"Unix/Aix/#renommer-un-lv","title":"Renommer un LV","text":"<p><code>chlv -n nouveau_nom ancien_nom</code> </p>"},{"location":"Unix/Aix/#divers","title":"Divers","text":""},{"location":"Unix/Aix/#watch-like-pour-aix","title":"\"watch like\" pour AIX","text":"<p><code>while true; do date; COMMAND ; sleep 1; clear; done</code> </p>"},{"location":"Unix/Aix/#determiner-le-type-darchitecture-32-ou-64bits","title":"D\u00e9terminer le type d'architecture (32 ou 64bits)","text":"<p><code>getconf KERNEL_BITMODE</code> </p>"},{"location":"Unix/Aix/#afficher-les-erreurs-systeme-unix","title":"Afficher les erreurs syst\u00e8me UNIX","text":"<p><code>errpt [Option] [ -c : rapport court ] [ -A : rapport simple ] [ -a : rapport d\u00e9taill\u00e9 ]</code> </p>"},{"location":"Unix/Aix/#afficher-les-ports-en-ecoute","title":"Afficher les ports en \u00e9coute","text":"<p><code>netstat -an -f inet | grep LISTEN</code> </p> <p> </p>"}]}